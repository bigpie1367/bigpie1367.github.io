<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>no_intellectual.log</title>
    <link>https://bigpie1367.github.io/</link>
    
    <atom:link href="https://bigpie1367.github.io/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>지적이지 못한 개발자의 로그</description>
    <pubDate>Tue, 27 Feb 2024 07:31:45 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>Docker Compose 사이의 Networking</title>
      <link>https://bigpie1367.github.io/2024/02/27/Docker-Compose-%EC%82%AC%EC%9D%B4%EC%9D%98-Networking/</link>
      <guid>https://bigpie1367.github.io/2024/02/27/Docker-Compose-%EC%82%AC%EC%9D%B4%EC%9D%98-Networking/</guid>
      <pubDate>Tue, 27 Feb 2024 07:25:09 GMT</pubDate>
      
      <description>&lt;h1 id=&quot;서론&quot;&gt;&lt;a href=&quot;#서론&quot; class=&quot;headerlink&quot; title=&quot;서론&quot;&gt;&lt;/a&gt;서론&lt;/h1&gt;&lt;p&gt;최근 SSO 서버 개발을 진행하였는데, 테스트를 진행함에 있어 서로 다른 두 도커 컴포즈로 구성된 프로젝트간에 API 요청이 필요한 상황이 발생하였다. 이 과정에서 네트워크 설정에 관해 학습한 내용 및 트러블슈팅을 기록으로 남기고자 한다&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;br&gt;&amp;nbsp;&lt;/p&gt;
&lt;h1 id=&quot;본론&quot;&gt;&lt;a href=&quot;#본론&quot; class=&quot;headerlink&quot; title=&quot;본론&quot;&gt;&lt;/a&gt;본론&lt;/h1&gt;&lt;h2 id=&quot;In-Docker-Compose&quot;&gt;&lt;a href=&quot;#In-Docker-Compose&quot; class=&quot;headerlink&quot; title=&quot;In Docker Compose&quot;&gt;&lt;/a&gt;In Docker Compose&lt;/h2&gt;&lt;p&gt;도커 컴포즈(Docker Compose)란 다수의 도커 컨테이너(Docker Container)들로 이루어진 애플리케이션을 보다 간편하게 관리하기 위한 도구이다. 이러한 도커 컴포즈로 구성된 프로젝트를 빌드할 경우 기본적으로 내부 컨테이너들간의 통신을 위한 &lt;code&gt;default&lt;/code&gt; 네트워크를 생성한다. 일반적으로 &lt;code&gt;프로젝트명_default&lt;/code&gt; 형식으로 생성된다.&lt;/p&gt;
&lt;p&gt;아래와 같은 도커 컴포즈 파일(docker-compose.yml)이 있을 때 구성된 네트워크를 살펴보면 다음과 같다.&lt;/p&gt;
&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# docker-compose.yml&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;version:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;3&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;services:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;django:&lt;/span&gt; &lt;span class=&quot;meta&quot;&gt;&amp;amp;django&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;build:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;context:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;..&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;dockerfile:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;./bin/compose/production/django/Dockerfile&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;image:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;my_project_django&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;depends_on:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;postgres&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;postgres:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;build:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;context:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;dockerfile:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;./compose/production/postgres/Dockerfile&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;image:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;my_project_postgres&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;nginx:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;build:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;context:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;..&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;dockerfile:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;./bin/compose/production/nginx/Dockerfile&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;image:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;my_project_nginx&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;ports:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;8412:80&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;depends_on:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;django&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 활성화된 도커 네트워크 확인&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;gt; docker network &lt;span class=&quot;built_in&quot;&gt;ls&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NETWORK ID     NAME                        DRIVER    SCOPE&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45afd37df4f2   bridge                      bridge    &lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;024ac5a121bb   host                        host      &lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;c2ad1c8aeadf   none                        null      &lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;fced302c4d64   my_project_default          bridge    &lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 활성화된 도커 네트워크 상세 정보&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;gt; docker network inspect my_project_default&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&amp;quot;Name&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;my_project_default&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&amp;quot;Id&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;34d046c7981b88c2df9dd4aacf5b130e4a92bf9c99bbc6d11e6c074bf72ab326&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&amp;quot;Created&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;2024-02-27T05:04:59.280736237Z&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&amp;quot;Scope&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;local&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&amp;quot;Driver&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;bridge&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&amp;quot;EnableIPv6&amp;quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&amp;quot;IPAM&amp;quot;&lt;/span&gt;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&amp;quot;Driver&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;default&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&amp;quot;Options&amp;quot;&lt;/span&gt;: null,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&amp;quot;Config&amp;quot;&lt;/span&gt;: [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;string&quot;&gt;&amp;quot;Subnet&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;192.168.128.0/20&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;string&quot;&gt;&amp;quot;Gateway&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;192.168.128.1&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&amp;quot;Internal&amp;quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&amp;quot;Attachable&amp;quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&amp;quot;Ingress&amp;quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&amp;quot;ConfigFrom&amp;quot;&lt;/span&gt;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&amp;quot;Network&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&amp;quot;ConfigOnly&amp;quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&amp;quot;Containers&amp;quot;&lt;/span&gt;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&amp;quot;01253d81aab5bc696bfff747e562b6efa49caf9ff12a89e012cfaae3f4671861&amp;quot;&lt;/span&gt;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;string&quot;&gt;&amp;quot;Name&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;my_project-nginx-1&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;string&quot;&gt;&amp;quot;EndpointID&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;a5a33350d0e2cacfaff9d270ceffd6397dacd2622e78802b5f01b9282a66d181&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;string&quot;&gt;&amp;quot;MacAddress&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;02:42:c0:a8:80:05&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;string&quot;&gt;&amp;quot;IPv4Address&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;192.168.128.3/20&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;string&quot;&gt;&amp;quot;IPv6Address&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&amp;quot;3feff36c3541910f679b04adba1076dcd6588ed5d830072b645a4ffff633b86e&amp;quot;&lt;/span&gt;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;string&quot;&gt;&amp;quot;Name&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;my_project-django-1&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;string&quot;&gt;&amp;quot;EndpointID&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;39614375de2f40039e890c01ad047b42074d051efb91ee70721b48ca930dc33a&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;string&quot;&gt;&amp;quot;MacAddress&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;02:42:c0:a8:80:04&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;string&quot;&gt;&amp;quot;IPv4Address&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;192.168.128.4/20&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;string&quot;&gt;&amp;quot;IPv6Address&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&amp;quot;9499f051f6d855a5b8c21e9c420fa2b284da70f98f3203d3ac6182f2cd952eae&amp;quot;&lt;/span&gt;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;string&quot;&gt;&amp;quot;Name&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;my_project-postgres-1&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;string&quot;&gt;&amp;quot;EndpointID&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;f4b38c73cff5c428857cfee1b56469accafa473137714cb8f028e21e6b952959&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;string&quot;&gt;&amp;quot;MacAddress&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;02:42:c0:a8:80:02&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;string&quot;&gt;&amp;quot;IPv4Address&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;192.168.128.2/20&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;string&quot;&gt;&amp;quot;IPv6Address&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&amp;quot;Options&amp;quot;&lt;/span&gt;: &amp;#123;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&amp;quot;Labels&amp;quot;&lt;/span&gt;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&amp;quot;com.docker.compose.network&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;default&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&amp;quot;com.docker.compose.project&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;my_project&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&amp;quot;com.docker.compose.version&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&amp;quot;2.23.3&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</description>
      
      
      
      <content:encoded><![CDATA[<h1 id="서론"><a href="#서론" class="headerlink" title="서론"></a>서론</h1><p>최근 SSO 서버 개발을 진행하였는데, 테스트를 진행함에 있어 서로 다른 두 도커 컴포즈로 구성된 프로젝트간에 API 요청이 필요한 상황이 발생하였다. 이 과정에서 네트워크 설정에 관해 학습한 내용 및 트러블슈팅을 기록으로 남기고자 한다</p><p>&nbsp;<br>&nbsp;</p><h1 id="본론"><a href="#본론" class="headerlink" title="본론"></a>본론</h1><h2 id="In-Docker-Compose"><a href="#In-Docker-Compose" class="headerlink" title="In Docker Compose"></a>In Docker Compose</h2><p>도커 컴포즈(Docker Compose)란 다수의 도커 컨테이너(Docker Container)들로 이루어진 애플리케이션을 보다 간편하게 관리하기 위한 도구이다. 이러한 도커 컴포즈로 구성된 프로젝트를 빌드할 경우 기본적으로 내부 컨테이너들간의 통신을 위한 <code>default</code> 네트워크를 생성한다. 일반적으로 <code>프로젝트명_default</code> 형식으로 생성된다.</p><p>아래와 같은 도커 컴포즈 파일(docker-compose.yml)이 있을 때 구성된 네트워크를 살펴보면 다음과 같다.</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># docker-compose.yml</span></span><br><span class="line"></span><br><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">django:</span> <span class="meta">&amp;django</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">      <span class="attr">context:</span> <span class="string">..</span></span><br><span class="line">      <span class="attr">dockerfile:</span> <span class="string">./bin/compose/production/django/Dockerfile</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">my_project_django</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">postgres</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">postgres:</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">      <span class="attr">context:</span> <span class="string">.</span></span><br><span class="line">      <span class="attr">dockerfile:</span> <span class="string">./compose/production/postgres/Dockerfile</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">my_project_postgres</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">nginx:</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">      <span class="attr">context:</span> <span class="string">..</span></span><br><span class="line">      <span class="attr">dockerfile:</span> <span class="string">./bin/compose/production/nginx/Dockerfile</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">my_project_nginx</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8412:80&quot;</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">django</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 활성화된 도커 네트워크 확인</span></span><br><span class="line"></span><br><span class="line">&gt; docker network <span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line">NETWORK ID     NAME                        DRIVER    SCOPE</span><br><span class="line">45afd37df4f2   bridge                      bridge    <span class="built_in">local</span></span><br><span class="line">024ac5a121bb   host                        host      <span class="built_in">local</span></span><br><span class="line">c2ad1c8aeadf   none                        null      <span class="built_in">local</span></span><br><span class="line">fced302c4d64   my_project_default          bridge    <span class="built_in">local</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 활성화된 도커 네트워크 상세 정보</span></span><br><span class="line"></span><br><span class="line">&gt; docker network inspect my_project_default</span><br><span class="line"></span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;my_project_default&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Id&quot;</span>: <span class="string">&quot;34d046c7981b88c2df9dd4aacf5b130e4a92bf9c99bbc6d11e6c074bf72ab326&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Created&quot;</span>: <span class="string">&quot;2024-02-27T05:04:59.280736237Z&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Scope&quot;</span>: <span class="string">&quot;local&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Driver&quot;</span>: <span class="string">&quot;bridge&quot;</span>,</span><br><span class="line">        <span class="string">&quot;EnableIPv6&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">&quot;IPAM&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;Driver&quot;</span>: <span class="string">&quot;default&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Options&quot;</span>: null,</span><br><span class="line">            <span class="string">&quot;Config&quot;</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">&quot;Subnet&quot;</span>: <span class="string">&quot;192.168.128.0/20&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;Gateway&quot;</span>: <span class="string">&quot;192.168.128.1&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;Internal&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">&quot;Attachable&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">&quot;Ingress&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">&quot;ConfigFrom&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;Network&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;ConfigOnly&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">&quot;Containers&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;01253d81aab5bc696bfff747e562b6efa49caf9ff12a89e012cfaae3f4671861&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;my_project-nginx-1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;EndpointID&quot;</span>: <span class="string">&quot;a5a33350d0e2cacfaff9d270ceffd6397dacd2622e78802b5f01b9282a66d181&quot;</span>,</span><br><span class="line">                <span class="string">&quot;MacAddress&quot;</span>: <span class="string">&quot;02:42:c0:a8:80:05&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv4Address&quot;</span>: <span class="string">&quot;192.168.128.3/20&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv6Address&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;3feff36c3541910f679b04adba1076dcd6588ed5d830072b645a4ffff633b86e&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;my_project-django-1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;EndpointID&quot;</span>: <span class="string">&quot;39614375de2f40039e890c01ad047b42074d051efb91ee70721b48ca930dc33a&quot;</span>,</span><br><span class="line">                <span class="string">&quot;MacAddress&quot;</span>: <span class="string">&quot;02:42:c0:a8:80:04&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv4Address&quot;</span>: <span class="string">&quot;192.168.128.4/20&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv6Address&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;9499f051f6d855a5b8c21e9c420fa2b284da70f98f3203d3ac6182f2cd952eae&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;my_project-postgres-1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;EndpointID&quot;</span>: <span class="string">&quot;f4b38c73cff5c428857cfee1b56469accafa473137714cb8f028e21e6b952959&quot;</span>,</span><br><span class="line">                <span class="string">&quot;MacAddress&quot;</span>: <span class="string">&quot;02:42:c0:a8:80:02&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv4Address&quot;</span>: <span class="string">&quot;192.168.128.2/20&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv6Address&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;Options&quot;</span>: &#123;&#125;,</span><br><span class="line">        <span class="string">&quot;Labels&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;com.docker.compose.network&quot;</span>: <span class="string">&quot;default&quot;</span>,</span><br><span class="line">            <span class="string">&quot;com.docker.compose.project&quot;</span>: <span class="string">&quot;my_project&quot;</span>,</span><br><span class="line">            <span class="string">&quot;com.docker.compose.version&quot;</span>: <span class="string">&quot;2.23.3&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>&nbsp;</p><p>도커 네트워크를 확인해보면 연결된 각 컨테이너별로 임의의 IP가 부여되었음을 확인할 수 있다. 해당 네트워크에 연결된 컨테이너간에는 부여된 IP 혹은 Alias(서비스 이름, 컨테이너 이름 or ID)를 통해서 접근할 수 있다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># my_project_django docker</span></span><br><span class="line"></span><br><span class="line">&gt; ping 192.168.128.3</span><br><span class="line"></span><br><span class="line">PING 192.168.128.3 (192.168.128.3) 56(84) bytes of data.</span><br><span class="line">64 bytes from 192.168.128.3: icmp_seq=1 ttl=64 time=0.049 ms</span><br><span class="line">64 bytes from 192.168.128.3: icmp_seq=2 ttl=64 time=0.042 ms</span><br><span class="line">64 bytes from 192.168.128.3: icmp_seq=3 ttl=64 time=0.064 ms</span><br><span class="line">64 bytes from 192.168.128.3: icmp_seq=4 ttl=64 time=0.043 ms</span><br><span class="line">64 bytes from 192.168.128.3: icmp_seq=5 ttl=64 time=0.061 ms</span><br><span class="line"></span><br><span class="line">--- 192.168.128.3 ping statistics ---</span><br><span class="line">5 packets transmitted, 5 received, 0% packet loss, time 4096ms</span><br><span class="line">rtt min/avg/max/mdev = 0.042/0.051/0.064/0.009 ms</span><br><span class="line"></span><br><span class="line">&gt; ping nginx</span><br><span class="line"></span><br><span class="line">PING nginx (192.168.128.3) 56(84) bytes of data.</span><br><span class="line">64 bytes from my_project-nginx-1.my_project_default (192.168.128.3): icmp_seq=1 ttl=64 time=0.080 ms</span><br><span class="line">64 bytes from my_project-nginx-1.my_project_default (192.168.128.3): icmp_seq=2 ttl=64 time=0.071 ms</span><br><span class="line">64 bytes from my_project-nginx-1.my_project_default (192.168.128.3): icmp_seq=3 ttl=64 time=0.060 ms</span><br><span class="line">64 bytes from my_project-nginx-1.my_project_default (192.168.128.3): icmp_seq=4 ttl=64 time=0.044 ms</span><br><span class="line">64 bytes from my_project-nginx-1.my_project_default (192.168.128.3): icmp_seq=5 ttl=64 time=0.085 ms</span><br><span class="line">^C</span><br><span class="line">--- nginx ping statistics ---</span><br><span class="line">5 packets transmitted, 5 received, 0% packet loss, time 4109ms</span><br><span class="line">rtt min/avg/max/mdev = 0.044/0.068/0.085/0.014 ms</span><br></pre></td></tr></table></figure><p>해당 도커의 Alias를 비롯한 상세 정보는 아래 명령어를 통해 확인할 수 있다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&gt; docker inspect my_project-django-1                                                           </span><br><span class="line"></span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;Id&quot;</span>: <span class="string">&quot;788be7c1addd717d0f24153d26b999b78d8fc72f9f233e8095556d06f313f270&quot;</span>,</span><br><span class="line">        </span><br><span class="line">&lt; 중략 &gt;</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;NetworkSettings&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;Bridge&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;SandboxID&quot;</span>: <span class="string">&quot;bc079bbbccf793165a1e4f1e13c67edf850a70d43c2d953149cf92fb7f504474&quot;</span>,</span><br><span class="line">            <span class="string">&quot;HairpinMode&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">&quot;LinkLocalIPv6Address&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;LinkLocalIPv6PrefixLen&quot;</span>: 0,</span><br><span class="line">            <span class="string">&quot;Ports&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;13200/tcp&quot;</span>: null</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;SandboxKey&quot;</span>: <span class="string">&quot;/var/run/docker/netns/bc079bbbccf7&quot;</span>,</span><br><span class="line">            <span class="string">&quot;SecondaryIPAddresses&quot;</span>: null,</span><br><span class="line">            <span class="string">&quot;SecondaryIPv6Addresses&quot;</span>: null,</span><br><span class="line">            <span class="string">&quot;EndpointID&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Gateway&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;GlobalIPv6Address&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;GlobalIPv6PrefixLen&quot;</span>: 0,</span><br><span class="line">            <span class="string">&quot;IPAddress&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;IPPrefixLen&quot;</span>: 0,</span><br><span class="line">            <span class="string">&quot;IPv6Gateway&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;MacAddress&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Networks&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;my_project&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;IPAMConfig&quot;</span>: null,</span><br><span class="line">                    <span class="string">&quot;Links&quot;</span>: null,</span><br><span class="line">                    <span class="string">&quot;Aliases&quot;</span>: [</span><br><span class="line">                        <span class="string">&quot;my_project-django-1&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;django&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;788be7c1addd&quot;</span></span><br><span class="line">                    ],</span><br><span class="line">                    <span class="string">&quot;MacAddress&quot;</span>: <span class="string">&quot;02:42:c0:a8:50:07&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;NetworkID&quot;</span>: <span class="string">&quot;59eee52a5c0d0828b000f4f4ee59ec73bf0abb8e3f0da7a99c7708c277c7481b&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;EndpointID&quot;</span>: <span class="string">&quot;8f27d94c137cf7a8f2b25d0837c94d39e379d889817df8cd6c430b84921a4530&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;Gateway&quot;</span>: <span class="string">&quot;192.168.80.1&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;IPAddress&quot;</span>: <span class="string">&quot;192.168.80.7&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;IPPrefixLen&quot;</span>: 20,</span><br><span class="line">                    <span class="string">&quot;IPv6Gateway&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;GlobalIPv6Address&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;GlobalIPv6PrefixLen&quot;</span>: 0,</span><br><span class="line">                    <span class="string">&quot;DriverOpts&quot;</span>: null</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>&nbsp;</p><p>단 이 과정에서 주의해야할 점은 컴포즈 내 도커 컨테이너가 특정 포트를 외부에 개방하고 있을 경우, 해당 컨테이너로 진입하기 위해선 외부로 노출된 포트가 아닌 내부 포트를 지정해야 한다. 일례로 위 컴포즈 내 Nginx 컨테이너의 경우 <code>8412:80</code> 을 통해 알 수 있듯이 <code>8412</code> 포트를 개방하여 <code>80</code> 번 포트로 포워딩을 진행하는데, 도커 컴포즈 내부 다른 컨테이너에서 해당 Nginx 컨테이너로 진입하고자 할 경우 <code>80</code> 번 포트를 사용해야 한다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt; tcpping 192.168.128.3 8412</span><br><span class="line"></span><br><span class="line"><span class="built_in">seq</span> 0: tcp response from 192.168.128.3 [closed]  0.069 ms</span><br><span class="line"><span class="built_in">seq</span> 1: tcp response from 192.168.128.3 [closed]  0.066 ms</span><br><span class="line"><span class="built_in">seq</span> 2: tcp response from 192.168.128.3 [closed]  0.062 ms</span><br><span class="line"><span class="built_in">seq</span> 3: tcp response from 192.168.128.3 [closed]  0.109 ms</span><br><span class="line"><span class="built_in">seq</span> 4: tcp response from 192.168.128.3 [closed]  0.203 ms</span><br><span class="line"></span><br><span class="line">&gt; tcpping 192.168.128.3 80</span><br><span class="line"></span><br><span class="line"><span class="built_in">seq</span> 0: tcp response from 192.168.128.3 [open]  0.069 ms</span><br><span class="line"><span class="built_in">seq</span> 1: tcp response from 192.168.128.3 [open]  0.066 ms</span><br><span class="line"><span class="built_in">seq</span> 2: tcp response from 192.168.128.3 [open]  0.062 ms</span><br><span class="line"><span class="built_in">seq</span> 3: tcp response from 192.168.128.3 [open]  0.109 ms</span><br><span class="line"><span class="built_in">seq</span> 4: tcp response from 192.168.128.3 [open]  0.203 ms</span><br></pre></td></tr></table></figure><p>&nbsp;<br>&nbsp;</p><h2 id="Between-Docker-Compose"><a href="#Between-Docker-Compose" class="headerlink" title="Between Docker Compose"></a>Between Docker Compose</h2><p>본 프로젝트를 개발하는 도중에 발생한 문제는 서로 다른 도커 컴포즈로 구성된 프로젝트를 로컬에서 실행하였는데, 기본적으로 default 네트워크는 외부에 공개가 되어있지 않아 컴포즈간의 통신이 불가능하였기 때문이다.  이를 해결할 수 있는 다양한 방법들이 존재하겠지만 테스트 단계이니만큼 간단한 방법으로 수정하였다.</p><p>우선 두 컴포즈가 공통으로 사용할 네트워크를 생성해준다</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker network create my_project</span><br></pre></td></tr></table></figure><p>&nbsp;</p><p>이후 각 도커 컴포즈 파일에서 해당 네트워크를 참조하도록 명시해준다. 연결할 다른 프로젝트의 도커 컴포즈 파일에도 아래와 동일한 방식으로 네트워크를 명시해주었다.</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># docker-compose.yml</span></span><br><span class="line"></span><br><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">django:</span> <span class="meta">&amp;django</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">      <span class="attr">context:</span> <span class="string">..</span></span><br><span class="line">      <span class="attr">dockerfile:</span> <span class="string">./bin/compose/production/django/Dockerfile</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">my_project_django</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">postgres</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">my_project</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">postgres:</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">      <span class="attr">context:</span> <span class="string">.</span></span><br><span class="line">      <span class="attr">dockerfile:</span> <span class="string">./compose/production/postgres/Dockerfile</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">my_project_postgres</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">my_project</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">nginx:</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">      <span class="attr">context:</span> <span class="string">..</span></span><br><span class="line">      <span class="attr">dockerfile:</span> <span class="string">./bin/compose/production/nginx/Dockerfile</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">my_project_nginx</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8412:80&quot;</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">django</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">my_project</span></span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">my_project:</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">internal:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>&nbsp;</p><p>이후 프로젝트를 빌드하면 다음과 같은 네트워크가 생성 되었음을 확인할 수 있다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; docker network <span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line">NETWORK ID     NAME                                     DRIVER    SCOPE</span><br><span class="line">45afd37df4f2   bridge                                   bridge    <span class="built_in">local</span></span><br><span class="line">024ac5a121bb   host                                     host      <span class="built_in">local</span></span><br><span class="line">59eee52a5c0d   my_project                               bridge    <span class="built_in">local</span></span><br><span class="line">c2ad1c8aeadf   none                                     null      <span class="built_in">local</span></span><br><span class="line">41fdadbf9aff   my_project_default                       bridge    <span class="built_in">local</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">&gt; docker network inspcet my_project</span><br><span class="line"></span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;my_project&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Id&quot;</span>: <span class="string">&quot;59eee52a5c0d0828b000f4f4ee59ec73bf0abb8e3f0da7a99c7708c277c7481b&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Created&quot;</span>: <span class="string">&quot;2024-02-26T23:13:36.51300227Z&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Scope&quot;</span>: <span class="string">&quot;local&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Driver&quot;</span>: <span class="string">&quot;bridge&quot;</span>,</span><br><span class="line">        <span class="string">&quot;EnableIPv6&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">&quot;IPAM&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;Driver&quot;</span>: <span class="string">&quot;default&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Options&quot;</span>: &#123;&#125;,</span><br><span class="line">            <span class="string">&quot;Config&quot;</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">&quot;Subnet&quot;</span>: <span class="string">&quot;192.168.80.0/20&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;Gateway&quot;</span>: <span class="string">&quot;192.168.80.1&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;Internal&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">&quot;Attachable&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">&quot;Ingress&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">&quot;ConfigFrom&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;Network&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;ConfigOnly&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">&quot;Containers&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;15484f36924b0f15a7ce29090563cf455cbff9035966badd2826bc13999f45a9&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;my_project-postgres-1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;EndpointID&quot;</span>: <span class="string">&quot;407da93da18a0acb89fcfd6963a5d1ceccc6ff89a505aad4d56500ff019aa98c&quot;</span>,</span><br><span class="line">                <span class="string">&quot;MacAddress&quot;</span>: <span class="string">&quot;02:42:c0:a8:50:05&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv4Address&quot;</span>: <span class="string">&quot;192.168.80.5/20&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv6Address&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;1904a079a0304805112084c0816d4b22c89addd454da4e3406453d4dd198b3bb&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;my_project-mssql-1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;EndpointID&quot;</span>: <span class="string">&quot;b84e1e7c816d33e8b3e842e39ca210357066a625366be7942f810fa13b5154bf&quot;</span>,</span><br><span class="line">                <span class="string">&quot;MacAddress&quot;</span>: <span class="string">&quot;02:42:c0:a8:50:06&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv4Address&quot;</span>: <span class="string">&quot;192.168.80.6/20&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv6Address&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;4a4aa5e022835443ed7dd2e5c36052cb43711fd2da9d8d8d6bd788bce18a3411&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;my_project_2-django-1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;EndpointID&quot;</span>: <span class="string">&quot;df5e099740e05637e14261f92d64517592197370fe4e4f6e64722c22dd411734&quot;</span>,</span><br><span class="line">                <span class="string">&quot;MacAddress&quot;</span>: <span class="string">&quot;02:42:c0:a8:50:03&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv4Address&quot;</span>: <span class="string">&quot;192.168.80.3/20&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv6Address&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;52de2bd8ed747dde0e7741a9dd2d7dfaadb5ca101177cbe99f75f4d31fbc07ec&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;my_project_2-postgres-1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;EndpointID&quot;</span>: <span class="string">&quot;7f266846bac3d81a4fd1292d564edf863f5fb2348cacdeb2ca8efaae4b6e3043&quot;</span>,</span><br><span class="line">                <span class="string">&quot;MacAddress&quot;</span>: <span class="string">&quot;02:42:c0:a8:50:02&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv4Address&quot;</span>: <span class="string">&quot;192.168.80.2/20&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv6Address&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;788be7c1addd717d0f24153d26b999b78d8fc72f9f233e8095556d06f313f270&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;my_project-django-1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;EndpointID&quot;</span>: <span class="string">&quot;8f27d94c137cf7a8f2b25d0837c94d39e379d889817df8cd6c430b84921a4530&quot;</span>,</span><br><span class="line">                <span class="string">&quot;MacAddress&quot;</span>: <span class="string">&quot;02:42:c0:a8:50:07&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv4Address&quot;</span>: <span class="string">&quot;192.168.80.7/20&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv6Address&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;7c14bbd8e71181a55ad5fa510b8fc8ff3e2b87a761c952255f442583d7ea210a&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;my_project-nginx-1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;EndpointID&quot;</span>: <span class="string">&quot;6e7cbbba63677f0f7592985802ee5896b1d429be3bf544dcfd0e59202f8b9ba5&quot;</span>,</span><br><span class="line">                <span class="string">&quot;MacAddress&quot;</span>: <span class="string">&quot;02:42:c0:a8:50:08&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv4Address&quot;</span>: <span class="string">&quot;192.168.80.8/20&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv6Address&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;915927a07f2645c214dac26ab3c870b32b9fa13cde13c1453984002bd205a206&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;my_project_2-nginx-1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;EndpointID&quot;</span>: <span class="string">&quot;673d094a037d12266250c50ad05b691031ad6630e10fde4d1b815c9346b65c43&quot;</span>,</span><br><span class="line">                <span class="string">&quot;MacAddress&quot;</span>: <span class="string">&quot;02:42:c0:a8:50:04&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv4Address&quot;</span>: <span class="string">&quot;192.168.80.4/20&quot;</span>,</span><br><span class="line">                <span class="string">&quot;IPv6Address&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;Options&quot;</span>: &#123;&#125;,</span><br><span class="line">        <span class="string">&quot;Labels&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>&nbsp;</p><p>상기 네트워크 정보와 같이 두 컴포즈의 각 컨테이너들이 한 네트워크를 공유하고 있음을 확인할 수 있다. 이전과 동일하게 IP 주소나 Alias를 통해서 각 컨테이너에 접근할  수 있다.</p><p>다만 이 과정에서 또다른 문제가 발생하였는데, 같은 템플릿에서 파생된 두 프로젝트이다보니 동일한 서비스 명을 공유하고 있었다. 이러할 경우 컨테이너 이름을 통해 다른 컨테이너에 연결을 시도할 경우 중복된 두 컨테이너 사이에서 갈팡질팡하는 상황이 발생하였다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; tcpping nginx 80</span><br><span class="line"></span><br><span class="line"><span class="built_in">seq</span> 0: tcp response from 192.168.80.8 [open]  0.240 ms</span><br><span class="line"><span class="built_in">seq</span> 1: tcp response from 192.168.80.8 [open]  0.094 ms</span><br><span class="line"><span class="built_in">seq</span> 2: tcp response from 192.168.80.4 [open]  0.064 ms</span><br><span class="line"><span class="built_in">seq</span> 3: tcp response from 192.168.80.8 [open]  0.071 ms</span><br><span class="line"><span class="built_in">seq</span> 4: tcp response from 192.168.80.4 [open]  0.066 ms</span><br><span class="line"><span class="built_in">seq</span> 5: tcp response from 192.168.80.8 [open]  0.082 ms</span><br><span class="line"><span class="built_in">seq</span> 6: tcp response from 192.168.80.4 [open]  0.093 ms</span><br><span class="line"><span class="built_in">seq</span> 7: tcp response from 192.168.80.4 [open]  0.072 ms</span><br></pre></td></tr></table></figure><p>&nbsp;</p><p>이를 방지하기 위해 서비스명을 중복되지 않도록 바꿔주거나 컨테이너 이름 혹은 ID를 통해 접근함으로써 해결할 수 있다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; tcpping my_project-nginx-1</span><br><span class="line"></span><br><span class="line"><span class="built_in">seq</span> 0: tcp response from 192.168.80.8 [open]  0.094 ms</span><br><span class="line"><span class="built_in">seq</span> 1: tcp response from 192.168.80.8 [open]  0.180 ms</span><br><span class="line"><span class="built_in">seq</span> 2: tcp response from 192.168.80.8 [open]  0.103 ms</span><br><span class="line"><span class="built_in">seq</span> 3: tcp response from 192.168.80.8 [open]  0.081 ms</span><br><span class="line"><span class="built_in">seq</span> 4: tcp response from 192.168.80.8 [open]  0.078 ms</span><br><span class="line"><span class="built_in">seq</span> 5: tcp response from 192.168.80.8 [open]  0.078 ms</span><br></pre></td></tr></table></figure><p>&nbsp;</p><h2 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h2><p><a href="https://www.daleseo.com/docker-networks/">Docker 네트워크 사용법</a></p><p><a href="https://www.daleseo.com/docker-compose-networks/">Docker Compose 네트워크</a></p><p><a href="https://captcha.tistory.com/70">도커 네트워크 (Docker Network)</a></p><p><a href="https://psawesome.tistory.com/75">docker compose 간 network 공유</a></p><p><a href="https://gngsn.tistory.com/137">Docker Network, 제대로 이해하기 (1)</a></p><p><a href="https://wiki.yowu.dev/ko/Knowledge-base/Docker/docker-compose-networking-connecting-containers-with-networks">Docker Compose 네트워킹: 컨테이너와 네트워크 연결</a></p>]]></content:encoded>
      
      
      <category domain="https://bigpie1367.github.io/categories/Infra/">Infra</category>
      
      
      <category domain="https://bigpie1367.github.io/tags/Infra/">Infra</category>
      
      <category domain="https://bigpie1367.github.io/tags/DevOps/">DevOps</category>
      
      <category domain="https://bigpie1367.github.io/tags/Docker/">Docker</category>
      
      <category domain="https://bigpie1367.github.io/tags/Docker-Compose/">Docker Compose</category>
      
      <category domain="https://bigpie1367.github.io/tags/Docker-Network/">Docker Network</category>
      
      
      <comments>https://bigpie1367.github.io/2024/02/27/Docker-Compose-%EC%82%AC%EC%9D%B4%EC%9D%98-Networking/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>MS SQL 데이터 송수신 자동화</title>
      <link>https://bigpie1367.github.io/2024/01/24/MS-SQL-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%86%A1%EC%88%98%EC%8B%A0-%EC%9E%90%EB%8F%99%ED%99%94/</link>
      <guid>https://bigpie1367.github.io/2024/01/24/MS-SQL-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%86%A1%EC%88%98%EC%8B%A0-%EC%9E%90%EB%8F%99%ED%99%94/</guid>
      <pubDate>Wed, 24 Jan 2024 00:22:24 GMT</pubDate>
      
      <description>&lt;h1 id=&quot;서론&quot;&gt;&lt;a href=&quot;#서론&quot; class=&quot;headerlink&quot; title=&quot;서론&quot;&gt;&lt;/a&gt;서론&lt;/h1&gt;&lt;h2 id=&quot;목적&quot;&gt;&lt;a href=&quot;#목적&quot; class=&quot;headerlink&quot; title=&quot;목적&quot;&gt;&lt;/a&gt;목적&lt;/h2&gt;&lt;p&gt;진행하는 프로젝트는 다른 외부 서비스로부터 우리 서비스에서 필요로하는 데이터를 수신받아야 하는데, 해당 외부 서비스에서 지원하는 DB가 &lt;code&gt;MS SQL&lt;/code&gt;, &lt;code&gt;Oracle&lt;/code&gt; 두 종류로 국한되는 상황이다. 반면 우리 프로젝트에서 사용할 DB는 &lt;code&gt;PostgreSQL&lt;/code&gt; 이다. 때문에 해당 외부 서비스로부터 데이터아 우리 서버로 옮겨줄 중계 DB가 필요한데, 이를 Naver Cloud Platform 내 클라우드 서버를 통해 수신받을 예정이다. 해당 클라우드 서버 설정은 &lt;a href=&quot;https://bigpie1367.github.io/2024/01/16/NCP-MS-SQL-in-macOS/&quot;&gt;이전&lt;/a&gt;에 다루었고 이번엔 수신받은 데이터를 어떻게 우리 서버로 옮길지에 대해 다루도록 하겠다.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;h2 id=&quot;고찰&quot;&gt;&lt;a href=&quot;#고찰&quot; class=&quot;headerlink&quot; title=&quot;고찰&quot;&gt;&lt;/a&gt;고찰&lt;/h2&gt;&lt;p&gt;네이버 클라우드상에 위치한 DB 서버로부터 데이터를 추출하기 위해선 다양한 방법이 있을 것 같다. 우선적으로 여러 방법들 중 어떤 방법이 가장 적절한지에 대해 고민하는 것이 선행되어야 할 필요가 있다. CSV 파일을 추출하여 &lt;code&gt;Gitlab&lt;/code&gt;에 업로드하는 것도 고려하였으나, 사원 정보를 &lt;code&gt;Gitlab&lt;/code&gt;과 같은 퍼블릭 저장소에 올리는 것은 적절한 방법이 아닌 것 같아 고려하지 않았다.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;h2 id=&quot;방법&quot;&gt;&lt;a href=&quot;#방법&quot; class=&quot;headerlink&quot; title=&quot;방법&quot;&gt;&lt;/a&gt;방법&lt;/h2&gt;&lt;p&gt;가장 처음 생각한 것은 데이터베이스에 데이터가 INSERT 되는 것을 감지하여 일련의 작업을 수행하는 것이었다. 찾아보니 &lt;code&gt;MSSQL Trigger&lt;/code&gt;를 통해 데이터가 &lt;code&gt;INSERT&lt;/code&gt; 되는 것을 감지할 수는 있으나, 해당 코드는 SQL 쿼리문으로만 작성되어야 했다. 수신 DB가 MSSQL로 동일하게 구현되었을 경우는 SQL 쿼리문을 통해 데이터 복사가 가능하였으나, 본 프로젝트엔 수신 DB가 PostgreSQL로 구현될 예정이기에 해당 방법은 배제하였다.&lt;/p&gt;
&lt;h3 id=&quot;스크립트를-통한-자동화&quot;&gt;&lt;a href=&quot;#스크립트를-통한-자동화&quot; class=&quot;headerlink&quot; title=&quot;스크립트를 통한 자동화&quot;&gt;&lt;/a&gt;스크립트를 통한 자동화&lt;/h3&gt;</description>
      
      
      
      <content:encoded><![CDATA[<h1 id="서론"><a href="#서론" class="headerlink" title="서론"></a>서론</h1><h2 id="목적"><a href="#목적" class="headerlink" title="목적"></a>목적</h2><p>진행하는 프로젝트는 다른 외부 서비스로부터 우리 서비스에서 필요로하는 데이터를 수신받아야 하는데, 해당 외부 서비스에서 지원하는 DB가 <code>MS SQL</code>, <code>Oracle</code> 두 종류로 국한되는 상황이다. 반면 우리 프로젝트에서 사용할 DB는 <code>PostgreSQL</code> 이다. 때문에 해당 외부 서비스로부터 데이터아 우리 서버로 옮겨줄 중계 DB가 필요한데, 이를 Naver Cloud Platform 내 클라우드 서버를 통해 수신받을 예정이다. 해당 클라우드 서버 설정은 <a href="https://bigpie1367.github.io/2024/01/16/NCP-MS-SQL-in-macOS/">이전</a>에 다루었고 이번엔 수신받은 데이터를 어떻게 우리 서버로 옮길지에 대해 다루도록 하겠다.</p><p>&nbsp;</p><h2 id="고찰"><a href="#고찰" class="headerlink" title="고찰"></a>고찰</h2><p>네이버 클라우드상에 위치한 DB 서버로부터 데이터를 추출하기 위해선 다양한 방법이 있을 것 같다. 우선적으로 여러 방법들 중 어떤 방법이 가장 적절한지에 대해 고민하는 것이 선행되어야 할 필요가 있다. CSV 파일을 추출하여 <code>Gitlab</code>에 업로드하는 것도 고려하였으나, 사원 정보를 <code>Gitlab</code>과 같은 퍼블릭 저장소에 올리는 것은 적절한 방법이 아닌 것 같아 고려하지 않았다.</p><p>&nbsp;</p><h2 id="방법"><a href="#방법" class="headerlink" title="방법"></a>방법</h2><p>가장 처음 생각한 것은 데이터베이스에 데이터가 INSERT 되는 것을 감지하여 일련의 작업을 수행하는 것이었다. 찾아보니 <code>MSSQL Trigger</code>를 통해 데이터가 <code>INSERT</code> 되는 것을 감지할 수는 있으나, 해당 코드는 SQL 쿼리문으로만 작성되어야 했다. 수신 DB가 MSSQL로 동일하게 구현되었을 경우는 SQL 쿼리문을 통해 데이터 복사가 가능하였으나, 본 프로젝트엔 수신 DB가 PostgreSQL로 구현될 예정이기에 해당 방법은 배제하였다.</p><h3 id="스크립트를-통한-자동화"><a href="#스크립트를-통한-자동화" class="headerlink" title="스크립트를 통한 자동화"></a>스크립트를 통한 자동화</h3><p>쉘 스크립트를 통해 데이터베이스로 쿼리를 날려 데이터 조회를 자동화할 수 있다. 데이터 추출은 원활히 동작하나, 실제 사용할 프로젝트 DB에 데이터를 전송하기 위해선 별도의 코드를 작성해야하기에 적절한 방법이 아닐 것 같아 배제하였다. </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sh get_data_from_table.sh &gt; data.txt</span></span><br><span class="line"></span><br><span class="line">CONTAINER_NAME=your_own_container_name</span><br><span class="line">DB_USER=your_own_username</span><br><span class="line">DB_PASS=your_own_pw</span><br><span class="line">DB_NAME=master</span><br><span class="line"></span><br><span class="line">SQL_SCRIPT=./data/sql_script.sql</span><br><span class="line"></span><br><span class="line"><span class="comment"># Run SQL script against MSSQL in Docker container</span></span><br><span class="line">docker <span class="built_in">exec</span> -it <span class="variable">$CONTAINER_NAME</span> /opt/mssql-tools/bin/sqlcmd \</span><br><span class="line">    -S localhost -U <span class="variable">$DB_USER</span> -P <span class="variable">$DB_PASS</span> -d <span class="variable">$DB_NAME</span> \</span><br><span class="line">    -Q <span class="string">&quot;SELECT * FROM dbo.TABLENAME&quot;</span></span><br></pre></td></tr></table></figure><h3 id="Python을-통한-자동화"><a href="#Python을-통한-자동화" class="headerlink" title="Python을 통한 자동화"></a>Python을 통한 자동화</h3><p>파이썬 코드를 통해 데이터 추출 &amp; 복사를 자동화할 수 있다. 해당 파이썬 코드를 크론잡을 통해 일정 주기마다 동작하도록 스케줄링하면 원활히 동작할 것으로 기대된다. 아래 코드를 통해 네이버 클라우드 서버상에 동작에 필요한 파이썬 및 필수 패키지를 설치할 수 있다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python 설치</span></span><br><span class="line">sudo apt install python3</span><br><span class="line"></span><br><span class="line"><span class="comment"># pip 설치</span></span><br><span class="line">sudo apt install python3-pip</span><br><span class="line"></span><br><span class="line"><span class="comment"># 필수 패키지 설치</span></span><br><span class="line">pip3 install pyodbc psycopg2</span><br></pre></td></tr></table></figure><details><summary>`pyodbc` 설치 과정에서 발생한 오류</summary><img width="1025" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-01-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10 26 10" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/49161197-761b-42bd-b132-22a0b9ceb5fb"><center>`sql.h` 헤더가 존재하지 않아 문제가 발생한 모습</center><p>&nbsp;</p><p><code>sql.h</code> 헤더가 존재하지 않아 설치 과정에서 오류 발생하여 아래 명령어를 순차적으로 수행하여 해결</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install unixodbc-dev</span><br><span class="line">pip install pyodbc</span><br></pre></td></tr></table></figure><p>&nbsp;</p></details><details><summary>`psycopg2` 설치 과정에서 발생한 오류</summary><img width="809" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-01-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10 33 49" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/dac11ac5-4e66-43b2-b29a-405d5e0664c5"><center>`psycopg2` 설치 과정에서 문제가 발생한 모습</center><p>&nbsp;</p><p>설치 과정에서 이미지와 같은 오류가 발생하였는데, <code>setuptools</code> 설치 과정에서 오류가 발생한 걸로 추측된다. 아래 명령어를 통해 해결할 수 있다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -H pip3 install --upgrade --ignore-installed pip setuptools</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://musclebear.tistory.com/131">https://musclebear.tistory.com/131</a> 참조</p></blockquote><p>&nbsp;</p></details><p>이후 아래 코드를 통해 소스 DB로부터 타겟 DB로 데이터를 복사할 수 있다. 해당 코드는 파이썬 코드상으로 직접 DB에 접근하여 특정 쿼리를 통해 데이터를 얻어온 뒤, 이를 CSV 파일로 저장한다. 이후 타겟 DB에 접속한 다음 추출된 CSV 파일을 기반으로 데이터를 옮기는 간단한 방법이다.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># copy_data.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pyodbc</span><br><span class="line"><span class="keyword">import</span> psycopg2</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># Original DB</span></span><br><span class="line">MSSQL_SERVER = <span class="string">&quot;your_server_ip&quot;</span></span><br><span class="line">MSSQL_PORT = <span class="string">&quot;your_server_port&quot;</span></span><br><span class="line">MSSQL_DATABASE = <span class="string">&quot;your_server_database&quot;</span></span><br><span class="line">MSSQL_USERNAME = <span class="string">&quot;your_server_username&quot;</span></span><br><span class="line">MSSQL_PASSWORD = <span class="string">&quot;user_server_pw&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Target DB</span></span><br><span class="line">PGSQL_SERVER = <span class="string">&quot;your_server_ip&quot;</span></span><br><span class="line">PGSQL_PORT = <span class="string">&quot;your_server_port&quot;</span></span><br><span class="line">PGSQL_DATABASE = <span class="string">&quot;your_server_database&quot;</span></span><br><span class="line">PGSQL_USERNAME = <span class="string">&quot;your_server_username&quot;</span></span><br><span class="line">PGSQL_PASSWORD = <span class="string">&quot;your_server_pw&quot;</span></span><br><span class="line"></span><br><span class="line">sql_query = <span class="string">&quot;SELECT * FROM your_table_name&quot;</span></span><br><span class="line"></span><br><span class="line">temp_file = <span class="string">&quot;temp_data.csv&quot;</span></span><br><span class="line"></span><br><span class="line">mssql_conn_string = <span class="string">f&#x27;DRIVER=&#123;&#123;ODBC Driver 17 for SQL Server&#125;&#125;;SERVER=<span class="subst">&#123;MSSQL_SERVER&#125;</span>,<span class="subst">&#123;MSSQL_PORT&#125;</span>;DATABASE=<span class="subst">&#123;MSSQL_DATABASE&#125;</span>;UID=<span class="subst">&#123;MSSQL_USERNAME&#125;</span>;PWD=<span class="subst">&#123;MSSQL_PASSWORD&#125;</span>&#x27;</span></span><br><span class="line">mssql_conn = pyodbc.connect(mssql_conn_string)</span><br><span class="line">cursor = mssql_conn.cursor()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(temp_file, <span class="string">&#x27;w&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line">    csv_writer = csv.writer(csvfile)</span><br><span class="line">    cursor.execute(sql_query)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> cursor:</span><br><span class="line">        csv_writer.writerow(row)</span><br><span class="line"></span><br><span class="line">cursor.close()</span><br><span class="line">mssql_conn.close()</span><br><span class="line"></span><br><span class="line">pgsql_conn = psycopg2.connect(</span><br><span class="line">    host=PGSQL_SERVER,</span><br><span class="line">    port=PGSQL_PORT,</span><br><span class="line">    database=PGSQL_DATABASE,</span><br><span class="line">    user=PGSQL_USERNAME,</span><br><span class="line">    password=PGSQL_PASSWORD</span><br><span class="line">)</span><br><span class="line">pgsql_cursor = pgsql_conn.cursor()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(temp_file, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    pgsql_cursor.copy_expert(<span class="string">&quot;COPY FROM STDIN WITH CSV HEADER&quot;</span>, f)</span><br><span class="line"></span><br><span class="line">pgsql_conn.commit()</span><br><span class="line">pgsql_cursor.close()</span><br><span class="line">pgsql_conn.close()</span><br><span class="line"></span><br><span class="line">os.remove(temp_file)</span><br></pre></td></tr></table></figure><p>상기 코드는 소스 데이터 테이블로부터 모든 데이터를 조회하여 전송하는 코드로, 실제 사용할 때에는 테이블의 전체 데이터를 조회하는 만큼 오버헤드가 발생할 것으로 생각된다. 따라서 상기 코드를 일정 간격으로 스케줄링 하여 해당 스케줄링 시간 간격만큼의 데이터만 조회하여 타겟 DB로 업데이트 하는 것이 적절한 방법일 것 같다.</p><p>아래는 매일 파이썬 함수를 실행한다고 할 때 <code>datetime</code> 모듈을 통해 오늘 날짜를 조회하여 쿼리문을 요청하는 예시이다.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 오늘 날짜를 기준으로 한 쿼리문</span></span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(코드 중략)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">current_date = datetime.datetime.now().strftime(<span class="string">&quot;%Y%m%d&quot;</span>)</span><br><span class="line">sql_query = <span class="string">f&quot;SELECT * FROM your_table_name WHERE column LIKE &#x27;<span class="subst">&#123;current_date&#125;</span>%&#x27;&quot;</span></span><br></pre></td></tr></table></figure><p><code>crontab</code>을 통해 해당 파이썬 코드 수행을 스케쥴링하여 매일 아침 7시에 수행될 수 있도록 자동화하였다. 또한 추후 확인을 위해 출력값을 <code>cron.log</code> 파일에 기록하여 확인할 수 있도록 하였다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># crontab 규칙</span></span><br><span class="line">* * * * *  유저 이름 명령어</span><br><span class="line">┬ ┬ ┬ ┬ ┬</span><br><span class="line">│ │ │ │ └─ 요일 (0 - 6) (0:일요일, 1:월요일, 2:화요일, …, 6:토요일)</span><br><span class="line">│ │ │ └─ 월 (1 - 12)</span><br><span class="line">│ │ └─일 (1 - 31)</span><br><span class="line">│ └─ 시 (0 - 23)</span><br><span class="line">└─ 분 (0 - 59)</span><br><span class="line"></span><br><span class="line"><span class="comment"># crontab 작업 추가</span></span><br><span class="line"><span class="comment"># 매일 아침 7시에 copy_data_to_pgsql.py를 수행</span></span><br><span class="line">$ crontab -e</span><br><span class="line">0 7 * * * /usr/bin/python3 /root/bin/copy_data_to_psql.py &gt;&gt; /root/logs/cron.log 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line"><span class="comment"># crontab 조회</span></span><br><span class="line">$ crontab -l</span><br><span class="line">0 7 * * * /usr/bin/python3 /root/bin/copy_data_to_psql.py &gt;&gt; /root/logs/cron.log 2&gt;&amp;1</span><br></pre></td></tr></table></figure><p>오류 로그 기록을 위해 <code>try-except</code> 및 다른 기능들을 적용한 최종 코드는 아래와 같다. 본 코드에서는 테스트를 위해 Naver Cloud Server와 AWS EC2 Instance를 활용하였다.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> pyodbc</span><br><span class="line"><span class="keyword">import</span> psycopg2</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># Original DB</span></span><br><span class="line">MSSQL_SERVER = <span class="string">&quot;your_server_ip&quot;</span></span><br><span class="line">MSSQL_PORT = <span class="string">&quot;your_server_port&quot;</span></span><br><span class="line">MSSQL_DATABASE = <span class="string">&quot;your_server_database&quot;</span></span><br><span class="line">MSSQL_USERNAME = <span class="string">&quot;your_server_username&quot;</span></span><br><span class="line">MSSQL_PASSWORD = <span class="string">&quot;user_server_pw&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Target DB</span></span><br><span class="line">PGSQL_SERVER = <span class="string">&quot;your_server_ip&quot;</span></span><br><span class="line">PGSQL_PORT = <span class="string">&quot;your_server_port&quot;</span></span><br><span class="line">PGSQL_DATABASE = <span class="string">&quot;your_server_database&quot;</span></span><br><span class="line">PGSQL_USERNAME = <span class="string">&quot;your_server_username&quot;</span></span><br><span class="line">PGSQL_PASSWORD = <span class="string">&quot;your_server_pw&quot;</span></span><br><span class="line"></span><br><span class="line">current_date = datetime.datetime.now().strftime(<span class="string">&quot;%Y%m%d&quot;</span>)</span><br><span class="line"></span><br><span class="line">log_directory = <span class="string">&quot;/root/logs&quot;</span></span><br><span class="line">temp_file = os.path.join(log_directory, <span class="string">f&quot;<span class="subst">&#123;current_date&#125;</span>_data.csv&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 로그 디렉토리 생성</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(log_directory):</span><br><span class="line">    os.makedirs(log_directory)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;current_date&#125;</span> 일자 데이터 전송 시작\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    sql_query = <span class="string">f&quot;SELECT * FROM your_table_name WHERE column LIKE &#x27;<span class="subst">&#123;current_date&#125;</span>%&#x27;&quot;</span></span><br><span class="line">    mssql_conn_string = <span class="string">f&#x27;DRIVER=&#123;&#123;ODBC Driver 17 for SQL Server&#125;&#125;;SERVER=<span class="subst">&#123;MSSQL_SERVER&#125;</span>,<span class="subst">&#123;MSSQL_PORT&#125;</span>;DATABASE=<span class="subst">&#123;MSSQL_DATABASE&#125;</span>;UID=<span class="subst">&#123;MSSQL_USERNAME&#125;</span>;PWD=<span class="subst">&#123;MSSQL_PASSWORD&#125;</span>&#x27;</span></span><br><span class="line">    mssql_conn = pyodbc.connect(mssql_conn_string)</span><br><span class="line"></span><br><span class="line">    cursor = mssql_conn.cursor()</span><br><span class="line">    cursor.execute(sql_query)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Table Column header 추출</span></span><br><span class="line">    columns = [column[<span class="number">0</span>] <span class="keyword">for</span> column <span class="keyword">in</span> cursor.description]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(temp_file, <span class="string">&#x27;w&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line">        csv_writer = csv.writer(csvfile)</span><br><span class="line">        csv_writer.writerow(columns)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> cursor:</span><br><span class="line">            csv_writer.writerow(row)</span><br><span class="line"></span><br><span class="line">    cursor.close()</span><br><span class="line">    mssql_conn.close()</span><br><span class="line"></span><br><span class="line">    pgsql_conn = psycopg2.connect(</span><br><span class="line">        host=PGSQL_SERVER,</span><br><span class="line">        port=PGSQL_PORT,</span><br><span class="line">        database=PGSQL_DATABASE,</span><br><span class="line">        user=PGSQL_USERNAME,</span><br><span class="line">        password=PGSQL_PASSWORD</span><br><span class="line">    )</span><br><span class="line">    pgsql_cursor = pgsql_conn.cursor()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(temp_file, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        pgsql_cursor.copy_expert(<span class="string">&quot;COPY your_table_name FROM STDIN WITH CSV HEADER&quot;</span>, f)</span><br><span class="line"></span><br><span class="line">    pgsql_conn.commit()</span><br><span class="line">    pgsql_cursor.close()</span><br><span class="line">    pgsql_conn.close()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;current_date&#125;</span> 일자 데이터 전송 완료\n&quot;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;current_date&#125;</span> 일자 작업 중 오류가 발생하였습니다 : <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /root/logs/cron.log</span></span><br><span class="line"><span class="number">20240117</span> 일자 데이터 전송 시작</span><br><span class="line"><span class="number">20240117</span> 일자 데이터 전송 완료</span><br><span class="line"></span><br><span class="line"><span class="comment"># /root/logs/20240117_data.csv</span></span><br><span class="line">your_table_data</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># PostgreSQL 테이블 생성에 사용한 쿼리문</span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> your_table_name (</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (PK1, PK2)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>&nbsp;</p><h2 id="서버-자동-시작-중지"><a href="#서버-자동-시작-중지" class="headerlink" title="서버 자동 시작 &amp; 중지"></a>서버 자동 시작 &amp; 중지</h2><p>상기 과정을 완료하였다면 네이버 클라우드 DB 상의 데이터를 일정 시간마다 자동으로 전송하는 환경 구성이 완료되었다. 해당 클라우드 서버는 다른 서비스로부터 일정 시간마다 데이터를 수신받는데, 이렇게 되면 해당 수신 서버를 항상 활성화해 놓는 것은 비용적인 측면에서 낭비일 수 있다. 따라서 이번에는 <code>Naver Cloud Functions</code>를 활용해 자동으로 해당 서버를 일정 시간마다 시작 &amp; 중지 할 수 있는 환경을 구성하려 한다.</p><h3 id="Naver-Cloud-Functions-이란"><a href="#Naver-Cloud-Functions-이란" class="headerlink" title="Naver Cloud Functions 이란"></a>Naver Cloud Functions 이란</h3><p><img src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/c27101f2-f174-43c9-b687-bfa326926e39" alt="Untitled"></p><center>Cloud Functions 상세 기능</center><p>&nbsp;</p><p>상기 이미지는 <a href="https://www.ncloud.com/product/compute/cloudFunctions">Naver Cloud Functions</a> 에 대한 기능을 간단히 도식화한 이미지이다. 간단히 설명하면 특정 이벤트 트리거를 통해 우리가 Python, JAVA등의 언어로 정의한 비즈니스 로직을 실행시켜 네이버 클라우드 플랫폼(NCP)에서 제공하는 다른 서비스들을 제어할 수 있는 것이다. 본 글에서는 <code>cron</code>(이벤트 트리거)를 통해 <code>Python</code>(비즈니스 로직) 코드를 실행시켜 직접 <code>Server</code>(서비스)를 제어하고자 한다.</p><h3 id="설정"><a href="#설정" class="headerlink" title="설정"></a>설정</h3><p>우선적으로 <code>트리거(Trigger)</code>를 설정해주어야 한다. 말 그대로 특정 이벤트 발생을 감지하여 일련의 코드를 동작시키기 위함으로, 본 프로젝트에서는 <code>cron</code> 을 트리거로 사용할 예정이다. Naver Cloud Functions에서 Trigger 탭 내의 ‘생성’ 버튼을 누르면 다음과 같은 화면을 볼 수 있다.</p><img width="1792" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-01-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10 57 46" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/bc9b7c14-4057-422c-a8eb-baa4735dfcf7"><center>Cloud Functions cron 생성 페이지</center><p>&nbsp;</p><p><code>cron</code> 작성 규칙은 위에서도 언급하였지만 다시 말하면 아래와 같다. 본 프로젝트에서는 7-9, 11-13, 15-17, 19-21 시간에만 서버를 활성화할 예정이다. 또한 주말에는 서버를 활성화할 필요가 없으므로 최종적으로 다음과 같이 2개의 <code>cron Trigger</code> 를 생성하였다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># crontab 규칙</span></span><br><span class="line">* * * * *  유저 이름 명령어</span><br><span class="line">┬ ┬ ┬ ┬ ┬</span><br><span class="line">│ │ │ │ └─ 요일 (0 - 6) (0:일요일, 1:월요일, 2:화요일, …, 6:토요일)</span><br><span class="line">│ │ │ └─ 월 (1 - 12)</span><br><span class="line">│ │ └─일 (1 - 31)</span><br><span class="line">│ └─ 시 (0 - 23)</span><br><span class="line">└─ 분 (0 - 59)</span><br></pre></td></tr></table></figure><img width="1041" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-01-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11 03 11" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/15434222-5f32-434e-9297-49408c3b49ad"><center>server-start-cron 설정</center><center>이미지 내 시간이 잘못되었는데, 7-21이다</center><p>&nbsp;</p><img width="1068" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-01-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11 04 07" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/e0055a5e-6604-4d53-917f-79dd40891483"><center>server-stop-cron 설정</center><p>&nbsp;</p><p>트리거 설정을 완료하였다면 이를 기반으로 적절한 액션(Action)을 설정해야한다. 액션은 네이버 클라우드에서 제공하는 API들을 파이썬 코드를 통해 호출하여 서버를 제어하기 위함이다. 자세한 API는 아래 링크에서 확인할 수 있다</p><blockquote><p><a href="https://api.ncloud-docs.com/">https://api.ncloud-docs.com/</a></p></blockquote><p>본 글에서는 서버 시작, 정지를 위해 <strong><code>startServerInstances</code>, <code>stopServerInstances</code></strong> 두 개의 API를 호출할 예정이다. 이를 위해 바로 액션을 설정하기에 앞서 패키지(Package)를 통해 두 API에서 공통적으로 필요한 데이터들을 관리하고자 한다.</p><img width="694" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-01-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11 09 08" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/519884fc-3614-4094-bbd9-99fe8379823f"><center>Cloud Functions Package 생성 페이지</center><p>&nbsp;</p><p>패키지 이름은 자유롭게 설정하면 되며 본 프로젝트에서는 <code>server-control</code> 로 정의하였다. 디폴트 파라미터로는 아래와 같이 설정해주었다. </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;API_URL&quot;</span>: <span class="string">&quot;https://ncloud.apigw.ntruss.com&quot;</span>,</span><br><span class="line"><span class="string">&quot;ACCESS_KEY&quot;</span>:<span class="string">&quot;&lt;클라우드 계정 ACCESS_KEY&gt;&quot;</span>,</span><br><span class="line"><span class="string">&quot;SECRET_KEY&quot;</span>:<span class="string">&quot;&lt;클라우드 계정 SECRET_KEY&gt;&quot;</span>,</span><br><span class="line"><span class="string">&quot;SERVER_LIST&quot;</span>:<span class="string">&quot;?serverInstanceNoList.1=&lt;본인의 서버 Instance ID&gt;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>API_URL을 제외한 나머지 값들의 경우 사람들마다 다르니 키 값의 경우 <code>계정 관리 &gt; 인증키 관리 &gt; API 인증키 관리</code>를 기반으로 값을 할당해주면 된다. <code>SERVER_LIST</code>는 아래 이미지처럼 본인이 생성한 서버 정보를 통해 확인할 수 있다.</p><img width="1503" alt="296932656-a56631ac-d0c9-450b-832a-248cee0aa14a" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/518b1015-3fba-4a08-ad42-249d5f1fc625"><center>Cloud Server 상세 정보</center><p>&nbsp;</p><p>이후 이를 기반으로 실제 수행할 코드를 담은 Action을 생성하고자 한다. 마찬가지로 Action또한 cron Trigger와 마찬가지로 서버 시작, 중지를 위해 2개를 필요로 한다.</p><ol><li>서버 시작용 Action</li></ol><ul><li>트리거 종류 : cron</li><li>트리거 이름 : server-start-cron (개인마다 상이할 수 있음)</li><li>패키지 : server-control (개인마다 상이할 수 있음)</li><li>소스코드 : python:3.7</li><li>디폴트 파라미터 : <code>&#123;&quot;API_URI&quot;: &quot;/server/v2/startServerInstances&quot;&#125;</code></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">args</span>):</span><br><span class="line"><span class="comment"># 패키지 파라미터</span></span><br><span class="line">    access_key = args[<span class="string">&quot;ACCESS_KEY&quot;</span>]</span><br><span class="line">    secret_key = args[<span class="string">&quot;SECRET_KEY&quot;</span>]</span><br><span class="line">    api_server = args[<span class="string">&quot;API_URL&quot;</span>]</span><br><span class="line">    api_uri = args[<span class="string">&quot;API_URI&quot;</span>]</span><br><span class="line">    server_list = args[<span class="string">&quot;SERVER_LIST&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 인증키 생성 시작 ===================</span></span><br><span class="line">    timestamp = <span class="built_in">int</span>(time.time() * <span class="number">1000</span>)</span><br><span class="line">    timestamp = <span class="built_in">str</span>(timestamp)</span><br><span class="line"></span><br><span class="line">    secret_key = <span class="built_in">bytes</span>(secret_key, <span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    method = <span class="string">&quot;GET&quot;</span></span><br><span class="line">    uri = api_uri + server_list</span><br><span class="line">        </span><br><span class="line">    message = method + <span class="string">&quot; &quot;</span> + uri + <span class="string">&quot;\n&quot;</span> + timestamp + <span class="string">&quot;\n&quot;</span> + access_key</span><br><span class="line">    message = <span class="built_in">bytes</span>(message, <span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">    signingKey = base64.b64encode(hmac.new(secret_key, message, digestmod=hashlib.sha256).digest())</span><br><span class="line"><span class="comment"># 인증키 생성 종료 ===================</span></span><br><span class="line"></span><br><span class="line">    http_header = &#123;</span><br><span class="line">        <span class="string">&#x27;x-ncp-apigw-signature-v2&#x27;</span>: signingKey,</span><br><span class="line">        <span class="string">&#x27;x-ncp-apigw-timestamp&#x27;</span>: timestamp,</span><br><span class="line">        <span class="string">&#x27;x-ncp-iam-access-key&#x27;</span>: access_key</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    response = requests.get(api_server + uri, headers=http_header)</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;서버 시작 완료&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p>&nbsp;</p><ol start="2"><li>서버 중지용 Action</li></ol><ul><li>트리거 종류 : cron</li><li>트리거 이름 : server-stop-cron (개인마다 상이할 수 있음)</li><li>패키지 : server-control (개인마다 상이할 수 있음)</li><li>소스코드 : python:3.7</li><li>디폴트 파라미터 : <code>&#123;&quot;API_URI&quot;: &quot;/server/v2/stopServerInstances&quot;&#125;</code></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">args</span>):</span><br><span class="line"><span class="comment"># 패키지 파라미터</span></span><br><span class="line">    access_key = args[<span class="string">&quot;ACCESS_KEY&quot;</span>]</span><br><span class="line">    secret_key = args[<span class="string">&quot;SECRET_KEY&quot;</span>]</span><br><span class="line">    api_server = args[<span class="string">&quot;API_URL&quot;</span>]</span><br><span class="line">    api_uri = args[<span class="string">&quot;API_URI&quot;</span>]</span><br><span class="line">    server_list = args[<span class="string">&quot;SERVER_LIST&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 인증키 생성 시작 ===================</span></span><br><span class="line">    timestamp = <span class="built_in">int</span>(time.time() * <span class="number">1000</span>)</span><br><span class="line">    timestamp = <span class="built_in">str</span>(timestamp)</span><br><span class="line"></span><br><span class="line">    secret_key = <span class="built_in">bytes</span>(secret_key, <span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    method = <span class="string">&quot;GET&quot;</span></span><br><span class="line">    uri = api_uri + server_list</span><br><span class="line">        </span><br><span class="line">    message = method + <span class="string">&quot; &quot;</span> + uri + <span class="string">&quot;\n&quot;</span> + timestamp + <span class="string">&quot;\n&quot;</span> + access_key</span><br><span class="line">    message = <span class="built_in">bytes</span>(message, <span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">    signingKey = base64.b64encode(hmac.new(secret_key, message, digestmod=hashlib.sha256).digest())</span><br><span class="line"><span class="comment"># 인증키 생성 종료 ===================</span></span><br><span class="line"></span><br><span class="line">    http_header = &#123;</span><br><span class="line">        <span class="string">&#x27;x-ncp-apigw-signature-v2&#x27;</span>: signingKey,</span><br><span class="line">        <span class="string">&#x27;x-ncp-apigw-timestamp&#x27;</span>: timestamp,</span><br><span class="line">        <span class="string">&#x27;x-ncp-iam-access-key&#x27;</span>: access_key</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    response = requests.get(api_server + uri, headers=http_header)</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;서버 종료 완료&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p>두 코드 모두 기본적으론 동일하나 사용된 디폴트 파라미터의 <code>API_URI</code>가 다름에 주의할 필요가 있다. 참고한 공식 문서는 다음과 같다.</p><blockquote><p><a href="https://api.ncloud-docs.com/docs/common-ncpapi">https://api.ncloud-docs.com/docs/common-ncpapi</a><br><a href="https://api.ncloud-docs.com/docs/compute-server">https://api.ncloud-docs.com/docs/compute-server</a><br><a href="https://api.ncloud-docs.com/docs/compute-server-startserverinstances">https://api.ncloud-docs.com/docs/compute-server-startserverinstances</a><br><a href="https://api.ncloud-docs.com/docs/compute-server-stopserverinstances">https://api.ncloud-docs.com/docs/compute-server-stopserverinstances</a></p></blockquote><p>이후 대시보드에서 설정한 시간마다 작업이 수행됨을 확인할 수 있다.</p><img width="1516" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-01-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12 48 38" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/50667d8b-2529-4ec9-bf84-1010918958fc"><center>서버 중지 작업이 성공적으로 수행된 모습</center><p>&nbsp;</p><h2 id="도커-자동실행"><a href="#도커-자동실행" class="headerlink" title="도커 자동실행"></a>도커 자동실행</h2><p>서버가 재부팅되면서 내부적으로 동작하고 있던 <code>MS SQL</code> 도커 컨테이너가 중단됨을 확인할 수 있다. 때문에 완전 자동화를 하기 위해선 재부팅할 때 도커 컨테이너를 자동으로 시작하도록 할 필요가 있다. </p><p>이전에 작성해 둔 스크립트를 <code>crontab</code> 에 등록하여 서버가 부팅될 시 자동으로 스크립트를 수행하여 도커 컨테이너를 실행하도록 구현하였다. 다만 이전 스크립트를 그대로 사용하기엔 <code>docker-compose</code> 환경변수나 실행 디렉토리 경로 문제로 인해 조금 수정하였다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># restart_docker.sh</span></span><br><span class="line"><span class="built_in">cd</span> /root/bin/</span><br><span class="line">/usr/local/bin/docker-compose -p incoroutine down</span><br><span class="line">/usr/local/bin/docker-compose -p incoroutine up -d</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># crontab에 작업 등록</span></span><br><span class="line">&gt; crontabe -e</span><br><span class="line">@reboot /root/bin/restart_docker.sh &gt;&gt; /root/logs/reboot_log.log 2&gt;&amp;1</span><br></pre></td></tr></table></figure><p>이후 서버를 재시작하면 정상적으로 도커 컨테이너가 실행됨을 확인할 수 있다.</p><p>&nbsp;</p><h1 id="참고-링크"><a href="#참고-링크" class="headerlink" title="참고 링크"></a>참고 링크</h1><p><a href="https://api.ncloud-docs.com/docs/common-ncpapi">Ncloud API</a></p><p><a href="https://api.ncloud-docs.com/docs/compute-server-stopserverinstances">stopServerInstances</a></p><p><a href="https://manvscloud.com/?p=1803">CLOUD FUNCTION으로 원하는 시간대에 서버를 시작하고 중지하자</a></p><p><a href="https://g-y-e-o-m.tistory.com/167">네이버클라우드플랫폼 사용시 Signature Key얻을 때!</a></p><p><a href="https://stackoverflow.com/questions/58292735/the-action-didnt-produce-the-valid-json-object-in-python-file">The action didn’t produce the valid JSON object in python file</a></p>]]></content:encoded>
      
      
      <category domain="https://bigpie1367.github.io/categories/Infra/">Infra</category>
      
      
      <category domain="https://bigpie1367.github.io/tags/Infra/">Infra</category>
      
      <category domain="https://bigpie1367.github.io/tags/DevOps/">DevOps</category>
      
      <category domain="https://bigpie1367.github.io/tags/Docker/">Docker</category>
      
      <category domain="https://bigpie1367.github.io/tags/MS-SQL/">MS SQL</category>
      
      <category domain="https://bigpie1367.github.io/tags/PostgreSQL/">PostgreSQL</category>
      
      
      <comments>https://bigpie1367.github.io/2024/01/24/MS-SQL-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%86%A1%EC%88%98%EC%8B%A0-%EC%9E%90%EB%8F%99%ED%99%94/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>NCP + MS SQL in macOS</title>
      <link>https://bigpie1367.github.io/2024/01/16/NCP-MS-SQL-in-macOS/</link>
      <guid>https://bigpie1367.github.io/2024/01/16/NCP-MS-SQL-in-macOS/</guid>
      <pubDate>Tue, 16 Jan 2024 04:15:18 GMT</pubDate>
      
      <description>&lt;h1 id=&quot;서론&quot;&gt;&lt;a href=&quot;#서론&quot; class=&quot;headerlink&quot; title=&quot;서론&quot;&gt;&lt;/a&gt;서론&lt;/h1&gt;&lt;p&gt;최근 회사 업무로 인해 네이버 클라우드 플랫폼(이하 NCP)에 MS SQL DB를 구축해야 할 일이 생겼다. 이에 자료를 찾아보니 Window 환경에서 MS SQL을 구축하는 정보들은 다수 존재하나 macOS 환경에서 구축하는 글은 드물어 관련 경험을 기록하고자 한다.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;h1 id=&quot;본론&quot;&gt;&lt;a href=&quot;#본론&quot; class=&quot;headerlink&quot; title=&quot;본론&quot;&gt;&lt;/a&gt;본론&lt;/h1&gt;&lt;h2 id=&quot;NCP-설정&quot;&gt;&lt;a href=&quot;#NCP-설정&quot; class=&quot;headerlink&quot; title=&quot;NCP 설정&quot;&gt;&lt;/a&gt;NCP 설정&lt;/h2&gt;&lt;p&gt;기본적으로 MS SQL을 NCP에서 호스팅하기 위해선 2가지 방법이 존재한다. &lt;/p&gt;
&lt;h3 id=&quot;Cloud-DB-for-mssql&quot;&gt;&lt;a href=&quot;#Cloud-DB-for-mssql&quot; class=&quot;headerlink&quot; title=&quot;Cloud DB for mssql&quot;&gt;&lt;/a&gt;Cloud DB for mssql&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;MSSQL을 위한 DBMS 및 각종 툴들이 설치된 상태&lt;/li&gt;
&lt;li&gt;별도의 데이터베이스 설정 없이 웹상에서 바로 모니터링 및 이용 가능&lt;/li&gt;
&lt;li&gt;스탠다드 기준 한달 62만원 정도의 비용 발생&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;Basic-Server&quot;&gt;&lt;a href=&quot;#Basic-Server&quot; class=&quot;headerlink&quot; title=&quot;Basic Server&quot;&gt;&lt;/a&gt;Basic Server&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;기본 Linux 서버로, MSSQL을 호스팅하기위한 별도의 설정이 필요함&lt;/li&gt;
&lt;li&gt;Ubuntu 18.04 환경&lt;/li&gt;
&lt;li&gt;스탠다드 기준 한달 7만원 정도의 비용 발생&lt;/li&gt;
&lt;/ul&gt;</description>
      
      
      
      <content:encoded><![CDATA[<h1 id="서론"><a href="#서론" class="headerlink" title="서론"></a>서론</h1><p>최근 회사 업무로 인해 네이버 클라우드 플랫폼(이하 NCP)에 MS SQL DB를 구축해야 할 일이 생겼다. 이에 자료를 찾아보니 Window 환경에서 MS SQL을 구축하는 정보들은 다수 존재하나 macOS 환경에서 구축하는 글은 드물어 관련 경험을 기록하고자 한다.</p><p>&nbsp;</p><h1 id="본론"><a href="#본론" class="headerlink" title="본론"></a>본론</h1><h2 id="NCP-설정"><a href="#NCP-설정" class="headerlink" title="NCP 설정"></a>NCP 설정</h2><p>기본적으로 MS SQL을 NCP에서 호스팅하기 위해선 2가지 방법이 존재한다. </p><h3 id="Cloud-DB-for-mssql"><a href="#Cloud-DB-for-mssql" class="headerlink" title="Cloud DB for mssql"></a>Cloud DB for mssql</h3><ul><li>MSSQL을 위한 DBMS 및 각종 툴들이 설치된 상태</li><li>별도의 데이터베이스 설정 없이 웹상에서 바로 모니터링 및 이용 가능</li><li>스탠다드 기준 한달 62만원 정도의 비용 발생</li></ul><h3 id="Basic-Server"><a href="#Basic-Server" class="headerlink" title="Basic Server"></a>Basic Server</h3><ul><li>기본 Linux 서버로, MSSQL을 호스팅하기위한 별도의 설정이 필요함</li><li>Ubuntu 18.04 환경</li><li>스탠다드 기준 한달 7만원 정도의 비용 발생</li></ul><p><del>해당 데이터베이스 서버를 단순 데이터 수신으로만 사용할 예정이므로 Basic Server에 Mssql Docker를 띄운 상태로 테스트를 진행할 예정이다.</del></p><p>기존에는 비용적인 측면에서 NCP에서 1년간 무료로 제공하는 Micro Server를 통해 MS SQL을 호스팅하려 하였으나, 네이버 클라우드에서 무료로 제공하는 Micro Server의 경우 메모리 1GB를 제공하는 반면 MS SQL을 서비스하기 위해선 최소 2GB의 메모리를 필요로 한다. 따라서 Micro Server가 아닌 Standard Server를 기준으로 테스트를 진행하고자 한다.</p><img width="1481" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-01-16_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_1 12 42" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/669f5ec2-ccc3-4a1d-b80a-e55d4d9a56cd"><center>클라우드 서버에서 사용할 OS</center><p>&nbsp;</p><img width="994" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-01-16_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10 55 26" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/4d243049-b5d2-4b11-8e8d-e75b3fb25462"><center>클라우드 서버 상세 정보</center><p>&nbsp;</p><img width="1503" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-01-15_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4 13 51" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/a56631ac-d0c9-450b-832a-248cee0aa14a"><center>최종 생성된 클라우드 서버</center><p>&nbsp;</p><p>추가로 본 글에서는 macOS 터미널을 통해 해당 클라우드 서버에 접속할 예정이다. NCP는 <code>SSH</code> 접속을 위한 <code>22</code>번 포트를 외부에서 접근하는 것을 허용하지 않아 포트 포워딩을 해주어야 한다.</p><img width="1506" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-01-15_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4 13 51 복사본" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/ea02819b-1083-46e9-8a35-6ce4afb242a2"><center>포트 포워딩 설정</center><p>&nbsp;</p><img width="992" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-01-16_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10 38 09" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/470d5181-9efe-4128-b102-fe383cc74040"><center>`22`번 포트(내부)를 `20001`번 포트(외부)로 포워딩</center><p>&nbsp;</p><p>이후 <code>20001</code>번 포트를 외부 IP에서 접근할 수 있도록 ACG에서 허용해주어야 한다. ACG는 일종의 방화벽으로, NCP에서 제공하는 IP 기반 필터링 기능이다. 본 글에서는 추가로 이후의 DB 접근을 위한 <code>20002</code>번 포트를 개방해주었다.</p><img width="1494" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-01-15_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4 14 33" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/3edc2a77-ae17-4213-bd45-b2bcc45798e1"><center>ACG 설정 페이지</center><p>&nbsp;</p><img width="1494" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-01-16_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10 37 22" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/73696fec-c5b2-49fa-8e2a-1c1af1229a34"><center>`20001` & `20002`번 포트를 외부에서 접근할 수 있도록 허용</center><p>&nbsp;</p><p>SSH만을 이용해 해당 서버에 접근하여 이용할 경우는 <code>서버 접속용 공인 IP</code>를 통해 접근해 이용하면 되지만, 외부에서 SSH가 아닌 DB에 직접 접근할 경우 <code>공인 IP</code> 할당을 필요로 한다. 다만 <code>공인 IP</code>의 경우 추가로 비용이 발생하니 유의할 필요가 있다. 발급받고 부여하는 과정은 간단해 최종 이미지만 첨부하도록 하겠다.</p><img width="1223" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-01-16_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12 41 29" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/2b891d36-c23a-4913-99b0-bd816ec316ee"><center>공인 IP 비용</center><p>&nbsp;</p><img width="1482" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-01-16_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11 13 49" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/c869c0e6-5125-457a-a92f-36e055835af6"><center>공인 IP 할당을 완료한 모습</center><p>&nbsp;</p><h2 id="MSSQL-설치"><a href="#MSSQL-설치" class="headerlink" title="MSSQL 설치"></a>MSSQL 설치</h2><p>상기 과정을 통해 NCP 설정을 완료하였다면 이제 해당 서버로 접근할 수 있다. 접근을 위한 명령어는 다음과 같다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># SSH를 통한 서버 내 접근</span></span><br><span class="line">ssh root@&lt;서버 접속용 공인 IP&gt; -p &lt;포워딩한 포트&gt;</span><br></pre></td></tr></table></figure><p>최초 접근할 경우 패스워드를 필요로 하는데, 초기 패스워드는 콘솔에서 서버 생성시 활용한 인증키를 통해 확인할 수 있다.</p><img width="1504" alt="스크린샷 2024-01-16 오후 1 48 41" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/e6afdfa4-10c1-415b-93a5-480d60598810"><center>초기 관리자 비밀번호 확인</center><p>&nbsp;</p><img width="495" alt="스크린샷 2024-01-16 오후 1 49 02" style="margin-left: auto; margin-right: auto; display: block;" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/edc0a9d7-6c88-4069-9788-d06a6a86c988"><center>초기 관리자 비밀번호 확인</center><p>&nbsp;</p><p>이후 서버에 접근한 뒤 MS SQL 서버를 호스팅하기 위한 도커 &amp; 도커 컴포즈를 아래 명령어를 통해 설치할 수 있다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Docker 설치를 위한 명령어</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 시스템 업데이트</span></span><br><span class="line">sudo apt update</span><br><span class="line"></span><br><span class="line"><span class="comment"># 필수 패키지 설치</span></span><br><span class="line">sudo apt install apt-transport-https ca-certificates curl software-properties-common</span><br><span class="line"></span><br><span class="line"><span class="comment"># Docker repository key 추가</span></span><br><span class="line">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span><br><span class="line"></span><br><span class="line"><span class="comment"># Docker repository 추가</span></span><br><span class="line">sudo add-apt-repository <span class="string">&quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 시스템 업데이트</span></span><br><span class="line">sudo apt update</span><br><span class="line"></span><br><span class="line"><span class="comment"># Docker 설치</span></span><br><span class="line">sudo apt install docker-ce</span><br><span class="line"></span><br><span class="line"><span class="comment"># Docker 권한 허용</span></span><br><span class="line">sudo usermod -aG docker <span class="variable">$USER</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Docker 실행 확인</span></span><br><span class="line">sudo systemctl status docker</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Docker-Compose 설치를 위한 명령어</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Docker-Compose 설치</span></span><br><span class="line">sudo curl -L <span class="string">&quot;https://github.com/docker/compose/releases/download/1.24.0/docker-compose-<span class="subst">$(uname -s)</span>-<span class="subst">$(uname -m)</span>&quot;</span> -o /usr/local/bin/docker-compose</span><br><span class="line"></span><br><span class="line"><span class="comment"># Docker-Compose 권한 허용</span></span><br><span class="line">sudo <span class="built_in">chmod</span> +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure><p>이후 MS SQL Docker를 위해 아래와 같이 <code>docker-compose.yml</code> 파일을 작성하였다. 해당 파일은 <code>2019-latest</code> 이미지를 활용하여 MS SQL Docker Container를 생성한다. 또한 데이터 처리를 도울 스크립트들과 데이터 보존을 위해 디렉토리들을 추가로 바운딩하였다.</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.7&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">    <span class="attr">sqlserver:</span></span><br><span class="line"><span class="attr">image:</span> <span class="string">mcr.microsoft.com/mssql/server:2019-latest</span></span><br><span class="line">        <span class="attr">user:</span> <span class="string">root</span></span><br><span class="line">        <span class="attr">container_name:</span> <span class="string">mssql_service</span></span><br><span class="line">        <span class="attr">hostname:</span> <span class="string">mssql</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="number">20002</span><span class="string">:1433</span></span><br><span class="line">        <span class="attr">expose:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&quot;20002&quot;</span></span><br><span class="line">        <span class="attr">volumes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">./../sql1data:/var/opt/mssql</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">./:/data</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">        <span class="attr">ACCEPT_EULA:</span> <span class="string">Y</span></span><br><span class="line">        <span class="attr">SA_PASSWORD:</span> <span class="string">YOUR_OWN_PASSWORD</span></span><br></pre></td></tr></table></figure><p>이후 작성한 <code>docker-compose.yml</code> 파일을 통해 MSSQL Docker Container를 동작시킨 뒤 접속하였다. 해당 과정을 스크립트를 통해 자동화하였다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># restart_docker.sh</span></span><br><span class="line">docker-compose -p incoroutine down</span><br><span class="line">docker-compose -p incoroutine up -d</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Docker 활성화</span></span><br><span class="line">sh restart_docker.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># Dokcer 내부 접속</span></span><br><span class="line">docker <span class="built_in">exec</span> -it mssql_service /bin/bash</span><br><span class="line"></span><br><span class="line"><span class="comment"># MSSQL 접속</span></span><br><span class="line">/opt/mssql-tools/bin/sqlcmd -S localhost -U SA -P YOUR_OWN_PASSWORD</span><br></pre></td></tr></table></figure><img width="1026" alt="스크린샷 2024-01-16 오전 10 46 44" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/bf6091d3-ac23-48bc-a373-81b57661c3d7"><center>MS SQL 접근에 성공할 경우 터미널 화면</center><p>&nbsp;</p><p>MS SQL에 정상적으로 접근됨을 확인하였으니 테이블을 생성해보자. 다만 필자는 MS SQL 문법을 다루는데 미숙함이 있어 해당 과정 또한 스크립트를 통해 자동화하였다. 아래 코드의 경우 테이블 정보를 비롯한 내용들은 본인의 필요에 따라 대체해야됨에 유의하자.</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># your_own_table.sql</span></span><br><span class="line"></span><br><span class="line"><span class="string">CREATE</span> <span class="string">TABLE</span> <span class="string">Tablename(</span></span><br><span class="line">    <span class="string">YOUR_OWN_CODE;</span></span><br><span class="line"><span class="string">)</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># create_table.sh</span></span><br><span class="line"></span><br><span class="line">CONTAINER_NAME=mssql_service</span><br><span class="line">DB_USER=SA</span><br><span class="line">DB_PASS=YOUR_OWN_PASSWORD</span><br><span class="line">DB_NAME=master</span><br><span class="line"></span><br><span class="line">SQL_SCRIPT=./data/your_own_table.sql</span><br><span class="line"></span><br><span class="line">docker <span class="built_in">exec</span> -it <span class="variable">$CONTAINER_NAME</span> /opt/mssql-tools/bin/sqlcmd \</span><br><span class="line">    -S localhost -U <span class="variable">$DB_USER</span> -P <span class="variable">$DB_PASS</span> -d <span class="variable">$DB_NAME</span> \</span><br><span class="line">    -i <span class="variable">$SQL_SCRIPT</span></span><br></pre></td></tr></table></figure><p>이후 해당 스크립트를 실행함으로써 도커 내부로 진입 없이 테이블 생성을 할 수 있다. 마찬가지로 아래 스크립트를 통해 해당 테이블로부터 데이터 조회를 자동화하였다. </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># get_table_data.sh</span></span><br><span class="line"></span><br><span class="line">CONTAINER_NAME=mssql_service</span><br><span class="line">DB_USER=SA</span><br><span class="line">DB_PASS=YOUR_OWN_PASSWORD</span><br><span class="line">DB_NAME=master</span><br><span class="line"></span><br><span class="line">SQL_SCRIPT=./data/secom_workhistory.sql</span><br><span class="line"></span><br><span class="line">docker <span class="built_in">exec</span> -it <span class="variable">$CONTAINER_NAME</span> /opt/mssql-tools/bin/sqlcmd \</span><br><span class="line">    -S localhost -U <span class="variable">$DB_USER</span> -P <span class="variable">$DB_PASS</span> \</span><br><span class="line">    -Q <span class="string">&quot;SELECT * FROM YOUR_ONW_TABLE&quot;</span></span><br></pre></td></tr></table></figure><p>추가로 별도의 프로그램을 통해 해당 데이터베이스로의 접근을 희망할 경우, 아래 정보를 통해 본인의 클라우드 서버 내 MS SQL로 진입할 수 있다.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Host : &lt;공인 IP&gt;</span><br><span class="line">Port : &lt;ACG에 등록한 포트 번호&gt;</span><br><span class="line">Database : master</span><br><span class="line">Table : YOUR_OWN_TABLE</span><br><span class="line">Username : SA</span><br><span class="line">Password : YOUR_OWN_PASSWORD</span><br></pre></td></tr></table></figure><p>&nbsp;</p><h1 id="참고-링크"><a href="#참고-링크" class="headerlink" title="참고 링크"></a>참고 링크</h1><p>Naver Cloud Platform (NCP) Server 생성, Putty 접속(<a href="https://seokd.tistory.com/40">https://seokd.tistory.com/40</a>)</p><p>Mac Pro 터미널을 이용해서 Remote 서버 SSH 접속 하기(<a href="https://page-view.tistory.com/32">https://page-view.tistory.com/32</a>)</p><p>네이버클라우드 적용기 - 공인 IP 생성 및 포트 포워딩, SSH 연결(<a href="https://catchdream.tistory.com/230">https://catchdream.tistory.com/230</a>)</p><p>네이버 클라우드 DB서버에 공인IP 없이 외부 원격 접속하기(<a href="https://prohannah.tistory.com/93">https://prohannah.tistory.com/93</a>)</p><p>Naver Cloud Platform 서버 세팅하기(<a href="https://eitu97.tistory.com/58">https://eitu97.tistory.com/58</a>)</p><p>Server 생성 후 SSH접속 및 Public IP 연결하여 외부 접속 방법(<a href="https://photofrontbboggi.tistory.com/entry/%EB%84%A4%EC%9D%B4%EB%B2%84%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C%ED%94%8C%EB%9E%AB%ED%8F%BC-Server-%EC%83%9D%EC%84%B1-%ED%9B%84-SSH%EC%A0%91%EC%86%8D-%EB%B0%8F-Public-IP-%EC%97%B0%EA%B2%B0%ED%95%98%EC%97%AC-%EC%99%B8%EB%B6%80-%EC%A0%91%EC%86%8D-%EB%B0%A9%EB%B2%95">https://photofrontbboggi.tistory.com/entry/네이버클라우드플랫폼-Server-생성-후-SSH접속-및-Public-IP-연결하여-외부-접속-방법</a>)</p><p>Ubuntu 18.04.x LTS에 docker 설치 하기(<a href="https://louky0714.tistory.com/131">https://louky0714.tistory.com/131</a>)</p><p>Docker로 MS-SQL Server 설치하기(<a href="https://www.lesstif.com/dbms/docker-ms-sql-server-113347394.html">https://www.lesstif.com/dbms/docker-ms-sql-server-113347394.html</a>)</p><p>MSSQL을 Docker Compose로 띄우기(<a href="https://basketdeveloper.tistory.com/89">https://basketdeveloper.tistory.com/89</a>)</p><p>MSSQL 기본 명령어 정리(<a href="https://kindmaster.tistory.com/188">https://kindmaster.tistory.com/188</a>)</p>]]></content:encoded>
      
      
      <category domain="https://bigpie1367.github.io/categories/Infra/">Infra</category>
      
      
      <category domain="https://bigpie1367.github.io/tags/Infra/">Infra</category>
      
      <category domain="https://bigpie1367.github.io/tags/DevOps/">DevOps</category>
      
      <category domain="https://bigpie1367.github.io/tags/Docker/">Docker</category>
      
      <category domain="https://bigpie1367.github.io/tags/Naver/">Naver</category>
      
      <category domain="https://bigpie1367.github.io/tags/NCP/">NCP</category>
      
      <category domain="https://bigpie1367.github.io/tags/MSSQL/">MSSQL</category>
      
      
      <comments>https://bigpie1367.github.io/2024/01/16/NCP-MS-SQL-in-macOS/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>AWS EC2 Jenkins를 통한 CI 환경 구축</title>
      <link>https://bigpie1367.github.io/2024/01/11/AWS-EC2-Jenkins%EB%A5%BC-%ED%86%B5%ED%95%9C-CI-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%B6%95/</link>
      <guid>https://bigpie1367.github.io/2024/01/11/AWS-EC2-Jenkins%EB%A5%BC-%ED%86%B5%ED%95%9C-CI-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%B6%95/</guid>
      <pubDate>Wed, 10 Jan 2024 23:28:47 GMT</pubDate>
      
      <description>&lt;h1 id=&quot;서론&quot;&gt;&lt;a href=&quot;#서론&quot; class=&quot;headerlink&quot; title=&quot;서론&quot;&gt;&lt;/a&gt;서론&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://bigpie1367.github.io/2024/01/05/Web-Server%EB%B6%80%ED%84%B0-Nginx%EA%B9%8C%EC%A7%80/&quot;&gt;이전 글&lt;/a&gt;을 통해 &lt;strong&gt;Docker-compose&lt;/strong&gt; 구성을 통한 각 서버별 &lt;strong&gt;Docker Container&lt;/strong&gt;들을 구성하였는데, 진행하다 보니 &lt;strong&gt;CI&lt;/strong&gt; 자동화도 알아보고 싶어 이에 대해 다루고자 한다. 본 글에서는 &lt;strong&gt;AWS EC2&lt;/strong&gt; 인스턴스 내 &lt;strong&gt;Jenkins&lt;/strong&gt;를 통해 &lt;strong&gt;CI&lt;/strong&gt; 자동화에 대해 다루고자 한다. 현재 회사 특성상 &lt;strong&gt;CD&lt;/strong&gt; 까지 진행하는데 어려움이 있을 듯 해 ‘&lt;strong&gt;CI&amp;#x2F;CD&lt;/strong&gt;’가 아닌, &lt;strong&gt;CI&lt;/strong&gt;만을 다루고자 한다.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;br&gt;&amp;nbsp;&lt;/p&gt;
&lt;h1 id=&quot;본론&quot;&gt;&lt;a href=&quot;#본론&quot; class=&quot;headerlink&quot; title=&quot;본론&quot;&gt;&lt;/a&gt;본론&lt;/h1&gt;&lt;h2 id=&quot;CI-CD-란&quot;&gt;&lt;a href=&quot;#CI-CD-란&quot; class=&quot;headerlink&quot; title=&quot;CI&amp;#x2F;CD 란?&quot;&gt;&lt;/a&gt;CI&amp;#x2F;CD 란?&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;CI&lt;/strong&gt; &amp;#x3D; 지속적인 통합(Continuous Integration)을 의미하는 단어로 ‘빌드와 테스트’를 자동화한 것이다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;CD&lt;/strong&gt; &amp;#x3D; 지속적인 전달(Continuous Delivery) or 지속적인 배포(Continuous Deployment)를 의미하는 단어로 CI가 완료된 이후 사용자에게 전달하는 배포 과정을 자동화한 것이다.&lt;/p&gt;
&lt;p&gt;즉, &lt;strong&gt;CI&lt;/strong&gt;는 개발 과정에서 필요한 빌드 및 테스트 단계를 자동화한 것이고 &lt;strong&gt;CD&lt;/strong&gt;는 테스트가 완료된 코드를 사용자에게 전달하기 위한 도구이다.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;h2 id=&quot;프로젝트-구성&quot;&gt;&lt;a href=&quot;#프로젝트-구성&quot; class=&quot;headerlink&quot; title=&quot;프로젝트 구성&quot;&gt;&lt;/a&gt;프로젝트 구성&lt;/h2&gt;</description>
      
      
      
      <content:encoded><![CDATA[<h1 id="서론"><a href="#서론" class="headerlink" title="서론"></a>서론</h1><p><a href="https://bigpie1367.github.io/2024/01/05/Web-Server%EB%B6%80%ED%84%B0-Nginx%EA%B9%8C%EC%A7%80/">이전 글</a>을 통해 <strong>Docker-compose</strong> 구성을 통한 각 서버별 <strong>Docker Container</strong>들을 구성하였는데, 진행하다 보니 <strong>CI</strong> 자동화도 알아보고 싶어 이에 대해 다루고자 한다. 본 글에서는 <strong>AWS EC2</strong> 인스턴스 내 <strong>Jenkins</strong>를 통해 <strong>CI</strong> 자동화에 대해 다루고자 한다. 현재 회사 특성상 <strong>CD</strong> 까지 진행하는데 어려움이 있을 듯 해 ‘<strong>CI&#x2F;CD</strong>’가 아닌, <strong>CI</strong>만을 다루고자 한다.</p><p>&nbsp;<br>&nbsp;</p><h1 id="본론"><a href="#본론" class="headerlink" title="본론"></a>본론</h1><h2 id="CI-CD-란"><a href="#CI-CD-란" class="headerlink" title="CI&#x2F;CD 란?"></a>CI&#x2F;CD 란?</h2><p><strong>CI</strong> &#x3D; 지속적인 통합(Continuous Integration)을 의미하는 단어로 ‘빌드와 테스트’를 자동화한 것이다.</p><p><strong>CD</strong> &#x3D; 지속적인 전달(Continuous Delivery) or 지속적인 배포(Continuous Deployment)를 의미하는 단어로 CI가 완료된 이후 사용자에게 전달하는 배포 과정을 자동화한 것이다.</p><p>즉, <strong>CI</strong>는 개발 과정에서 필요한 빌드 및 테스트 단계를 자동화한 것이고 <strong>CD</strong>는 테스트가 완료된 코드를 사용자에게 전달하기 위한 도구이다.</p><p>&nbsp;</p><h2 id="프로젝트-구성"><a href="#프로젝트-구성" class="headerlink" title="프로젝트 구성"></a>프로젝트 구성</h2><img width="1200" alt="스크린샷 2024-01-11 오전 7 47 01" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/a15be20e-6b0f-44f2-98a0-41f34efc4ff3"><center>프로젝트 전체 구성도</center><p>&nbsp;</p><p>전체 프로젝트 구성은 위 사진과 같다. 사용자가 코드를 깃 저장소에 올릴 경우 <strong>Github Webhook</strong>을 통해 해당 코드 내용을 <strong>Jenkins Docker Container</strong>에 반영한다. 이후 <strong>Jenkins</strong>가 <strong>Migration, Test</strong>를 비롯한 일련의 작업들을 수행하는 구조이다.</p><p>위에서 언급했듯이 본 프로젝트에서는 <strong>CI</strong> 환경 구축만을 목표로 하였기 때문에 별도의 <strong>Docker</strong> <strong>Hub</strong>와의 연결 없이 테스트 단계에서 마무리하도록 하겠다.</p><p>&nbsp;</p><h2 id="AWS-EC2-인스턴스-생성"><a href="#AWS-EC2-인스턴스-생성" class="headerlink" title="AWS EC2 인스턴스 생성"></a>AWS EC2 인스턴스 생성</h2><p>EC2에 대해 보다 자세히 다룬 글들이 존재하기에 참조할만한 링크만 추가한 뒤 본 글에서는 EC2 인스턴스를 통해 자동화하는 과정에 대해 집중적으로 다루고자 한다.</p><blockquote><p><a href="https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/UserGuide/concepts.html">Amazon EC2란 무엇인가요?</a></p></blockquote><p>기존 활용하던 인스턴스가 아닌 새로 인스턴스를 생성하여 설명하도록 하겠다. 추가로 본 글에서는 ‘프리 티어’를 기준으로 설명하므로 이를 인지하고 살펴볼 필요가 있다.</p><p>&nbsp;</p><h3 id="신규-인스턴스-생성"><a href="#신규-인스턴스-생성" class="headerlink" title="신규 인스턴스 생성"></a>신규 인스턴스 생성</h3><p>상단 레드박스 내 버튼을 통해 신규 인스턴스를 생성할 수 있다</p><img width="1792" alt="스크린샷 2024-01-09 오전 8 26 50" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/e8d7dcef-00e7-4be5-a57a-16414b8e77c9"><center>인스턴스 목록 화면</center><p>&nbsp;</p><h3 id="Application-and-OS-Images"><a href="#Application-and-OS-Images" class="headerlink" title="Application and OS Images"></a>Application and OS Images</h3><p><strong>AMI</strong>(<strong>Amazon Machine Image</strong>)는 해당 <strong>EC2</strong> 인스턴스의 베이스가 될 OS를 선택하는 것인데, 본 글에서는 <code>Amazon Linux 2</code>를 기준으로 설명하고자 한다. <code>Ubuntu</code>를 기준으로 하고자 할 경우 다른 AMI를 선택하면 된다.</p><img width="1792" alt="스크린샷 2024-01-09 오전 8 28 42" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/bd4108bb-09c7-4413-bcda-13d448299270"><center>인스턴스 생성 초기 화면</center><p>&nbsp;</p><img width="1792" alt="스크린샷 2024-01-09 오전 8 36 06" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/df1cb8a9-b6d2-45cf-8a83-4eb30aa86fed"><center>Amazon Linux 2 기준</center><p>&nbsp;</p><h3 id="인스턴스-유형-및-키-페어"><a href="#인스턴스-유형-및-키-페어" class="headerlink" title="인스턴스 유형 및 키 페어"></a>인스턴스 유형 및 키 페어</h3><p>인스턴스도 마찬가지로 기본 인스턴스인 t2.micro를 활용할 예정이다. 다음으로 중요한 부분은 키페어에 관련된 부분인데, 추후 해당 키 페어를 통해 SSH 접속에 활용할 예정이니 주의깊게 살펴야 한다.</p><img width="1792" alt="스크린샷 2024-01-09 오전 8 38 53" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/27d17ec7-87fa-4eb2-a340-4e02f383b56e"><center>키 페어 설정 화면</center><p>&nbsp;</p><p>키페어 이름을 설정한 뒤 생성을 하면 로컬에 키페어가 다운로드 된다. 추후 해당 키페어가 위치한 디렉토리에서 SSH 접속을 해야하므로 안전한 곳에 보관하면 된다.</p><img width="1792" alt="스크린샷 2024-01-09 오전 8 44 34" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/f5f8291a-497e-47df-b18f-338267e2467c"><center>키 페어 생성 화면</center><p>&nbsp;</p><h3 id="네트워크-구성"><a href="#네트워크-구성" class="headerlink" title="네트워크 구성"></a>네트워크 구성</h3><p>네트워크 구성의 경우 외부에서 Jenkins 접근을 허용하기 위해 <code>8080</code> 포트를 추가로 개방해주었다. 특정 포트에 대해 외부로부터의 접근을 허용하는 것을 ‘인바운드 규칙’이라 하는데, 본 글에서는 <code>8080</code> 포트만 활용할 예정이므로 추가적으로 이에 대해 다루진 않겠다.</p><img width="1792" alt="스크린샷 2024-01-09 오전 8 49 22" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/ed7d7b84-b42c-4473-9966-0f374a05d2f5"><center>인바운드 보안 그룹 설정 화면</center><p>&nbsp;</p><h3 id="인스턴스-생성-완료"><a href="#인스턴스-생성-완료" class="headerlink" title="인스턴스 생성 완료"></a>인스턴스 생성 완료</h3><p>상기 과정을 완료했다면 아래 이미지처럼 인스턴스가 성공적으로 생성되었음을 확인할 수 있다</p><img width="1792" alt="스크린샷 2024-01-09 오전 8 53 21" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/2ff3b027-2bda-4add-92a8-5fa37bc7b3c8"><center>인스턴스 생성 완료시 화면</center><p>&nbsp;</p><h3 id="인스턴스-접근"><a href="#인스턴스-접근" class="headerlink" title="인스턴스 접근"></a>인스턴스 접근</h3><p>정상적으로 인스턴스 생성이 완료되었다면 이전 과정에서 생성한 키 페어를 통해 인스턴스 내부에 접근할 수 있다. 본인의 키 페어가 위치한 디렉토리에서 <code>ssh -i &lt;키페어 이름&gt;.pem ec2-user@&lt;퍼블릭 IP&gt;</code> 를 통해 인스턴스 내부로 접근할 수 있다.</p><img width="1792" alt="스크린샷 2024-01-09 오전 8 59 25" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/4aba660c-54b9-4eb6-9731-c509401e6fab"><center>SSH를 통한 인스턴스 접근 화면</center><p>&nbsp;</p><p>그런데 접근을 시도할 경우 위 이미지처럼 에러가 발생함을 확인할 수 있다. 이는 최초 다운로드된 키 페어의 경우 접근 권한이 외부인에게도 허용된 상태이기 때문인데, <code>sudo chmod 400 test.pem</code>  명령어를 통해 해당 키 페어의 권한을 변경해주면 정상적으로 인스턴스에 접근할 수 있다.</p><img width="1792" alt="스크린샷 2024-01-09 오전 9 09 25" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/9808cd37-d495-4709-b272-5849066430d8"><center>인스턴스 접근에 성공할 시 화면</center><p>&nbsp;<br>&nbsp;</p><h2 id="Jenkins-설치-설정"><a href="#Jenkins-설치-설정" class="headerlink" title="Jenkins 설치 &amp; 설정"></a>Jenkins 설치 &amp; 설정</h2><p>본 글에서는 EC2 인스턴스 내 도커를 설치한 뒤, Jenkins Container를 띄울 예정이다. Docker 내부에 Jenkins를 설치하지 않고 EC2 자체에 Jenkins를 설치하는 방법도 존재하나, 설치 및 관리의 편의성으로 인해 이러한 방법을 채택하였다.</p><p>아래 일련의 명령어를 수행함으로써 필수 패키지 및 Docker를 설치할 수 있다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 패키지 업데이트</span></span><br><span class="line">sudo yum update</span><br><span class="line"></span><br><span class="line"><span class="comment"># Docker 관련 패키지 설치</span></span><br><span class="line">sudo yum install docker docker.io</span><br><span class="line"></span><br><span class="line"><span class="comment"># Docker 서비스 실행</span></span><br><span class="line">sudo service docker start</span><br><span class="line"></span><br><span class="line"><span class="comment"># 사용자를 User Group에 추가</span></span><br><span class="line">sudo usermod -a -G docker <span class="variable">$USER</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 부팅 시 Docker 자동 시작</span></span><br><span class="line">sudo systemctl <span class="built_in">enable</span> docker</span><br><span class="line"></span><br><span class="line"><span class="comment"># 권한 설정</span></span><br><span class="line">newgrp docker</span><br><span class="line"></span><br><span class="line"><span class="comment"># docker-compose 설치</span></span><br><span class="line">sudo curl -L https://github.com/docker/compose/releases/download/1.22.0/docker-compose-$(<span class="built_in">uname</span> -s)-$(<span class="built_in">uname</span> -m) -o /usr/local/bin/docker-compose</span><br><span class="line"></span><br><span class="line"><span class="comment"># docker-compose 권한 부여</span></span><br><span class="line">sudo <span class="built_in">chmod</span> +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure><p>위 과정을 완료하였다면 아래 명령어들을 통해 정상적으로 설치 및 실행이 완료되었음을 확인할 수 있다</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Docker 설치 확인</span></span><br><span class="line">[ec2-user@ip-172-31-6-223 ~]$ docker -v</span><br><span class="line">Docker version 20.10.25, build b82b9f3</span><br><span class="line"></span><br><span class="line"><span class="comment"># Docker 실행 확인</span></span><br><span class="line">[ec2-user@ip-172-31-6-223 ~]$ sudo systemctl status docker</span><br><span class="line">● docker.service - Docker Application Container Engine</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/docker.service; disabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since 화 2024-01-09 00:54:38 UTC; 33min ago</span><br><span class="line"></span><br><span class="line">(중략)</span><br></pre></td></tr></table></figure><p>이후 <code>docker-compose.yml</code> 파일을 통해 Jenkins Container를 구성해보겠다.</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pwd : /home/ec2-user/docker-compsoe.yml</span></span><br><span class="line"></span><br><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">    <span class="attr">jenkins:</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">jenkins/jenkins:lts</span></span><br><span class="line">        <span class="attr">container_name:</span> <span class="string">jenkins</span></span><br><span class="line">        <span class="attr">volumes:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">/var/run/docker.sock:/var/run/docker.sock.</span>   <span class="comment"># 컨테이너 내 Docker 실행을 위함</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">/jenkins:/var/jenkins_home</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&quot;8080:8080&quot;</span></span><br><span class="line">        <span class="attr">privileged:</span> <span class="literal">true</span>    <span class="comment"># 컨테이너 내부 자원 접근을 위함</span></span><br><span class="line">        <span class="attr">user:</span> <span class="string">root</span>          <span class="comment"># root 권한 설정</span></span><br></pre></td></tr></table></figure><p>아래 명령어들을 통해 도커 생성 및 확인을 할 수 있다</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pwd : /home/ec2-user</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Docker-compose 실행</span></span><br><span class="line">docker-compose up -d</span><br><span class="line"></span><br><span class="line"><span class="comment"># Docker container 확인</span></span><br><span class="line">docker ps</span><br><span class="line">CONTAINER ID   IMAGE                 COMMAND                  CREATED         STATUS         PORTS                                                  NAMES</span><br><span class="line">07b7e38fdd22   jenkins/jenkins:lts   <span class="string">&quot;/usr/bin/tini -- /u…&quot;</span>   2 minutes ago   Up 2 minutes   0.0.0.0:8080-&gt;8080/tcp, :::8080-&gt;8080/tcp, 50000/tcp   jenkins</span><br></pre></td></tr></table></figure><p>상기 과정을 모두 정상적으로 수행하였다면 브라우저 상에서 <code>&lt;퍼블릭 IP&gt;:8080</code> 을 통해 Jenkins를 사용할 수 있다.</p><img width="1792" alt="스크린샷 2024-01-09 오전 10 39 21" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/faab1412-d2e7-4e89-b7d1-1956ecd674d2"><center>Jenkins 초기 화면</center><p>&nbsp;</p><p>Jenkins를 활성화하기 위한 비밀번호는 <code>docker logs &lt;container 이름&gt;</code> 명령어를 통해 확인할 수 있다.</p><img width="1792" alt="스크린샷 2024-01-09 오전 10 45 05" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/5ff33a46-4cf7-4a46-8be9-b2f48987f38a"><center>Jenkins 활성화를 위한 비밀번호</center><p>&nbsp;</p><p>이후 패키지를 설치할 수 있는데, 대부분 좌측 기본 패키지 설치하는 것을 권장한다</p><img width="1792" alt="스크린샷 2024-01-09 오전 10 47 03" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/f5f46965-0b5f-425a-a341-ce4ac4705183"><center>Jenkins 패키지 설치 화면</center><p>&nbsp;</p><p>패키지 설치를 완료한 뒤 로그인에 사용할 관리자 계정을 생성해주면 Jenkins 설정은 끝이다.</p><img width="1792" alt="스크린샷 2024-01-09 오전 10 48 26" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/abea3dfd-4bc2-4bda-b51e-d0d5ba20c39b"><center>설정을 완료한 뒤 Jenkins 화면</center><p>&nbsp;<br>&nbsp;</p><h2 id="Github-Webhook-연결"><a href="#Github-Webhook-연결" class="headerlink" title="Github Webhook 연결"></a>Github Webhook 연결</h2><p>Github Webhook을 통해 Github 저장소에 코드가 변경될 경우(push, merge request, …) 자동적으로 빌드를 수행하게끔 하고자 한다. Github 저장소와의 연결을 위해 Credential을 만들어야 한다.</p><img width="1792" alt="스크린샷 2024-01-09 오전 10 54 08" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/3f2a682f-b554-4997-9245-b7c6530ae409"><center>Jenkins Credential 설정 화면 - 1</center><p>&nbsp;</p><img width="1792" alt="스크린샷 2024-01-09 오전 10 55 40" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/e96f9a8d-56ac-4ac0-bb13-f7818ce9f7fd"><center>Jenkins Credential 설정 화면 - 2</center><p>&nbsp;</p><img width="1792" alt="스크린샷 2024-01-09 오전 10 55 47" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/ba7ef3e0-8133-430f-a6e4-9856cd4100e3"><center>Jenkins Credential 설정 화면 - 3</center><p>&nbsp;</p><p>아래 페이지에서 <code>username</code> : Github ID, <code>Password</code> : Github Access Token 를 입력한 뒤 <code>ID</code> 는 자유롭게 입력하면 된다. <code>ID</code> 를 입력하지 않을 경우 자동으로 생성되나 구분을 위해 별도로 선언하는 편이 좋다.</p><p><img src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/48c2ea6d-6d65-401e-ab7b-0b2a49a11d7e" alt="스크린샷 2024-01-09 오전 10 56 14"></p><center>Jenkins Credential 설정 화면 - 4</center><p>&nbsp;</p><p>이후 연결하고자 하는 저장소에 들어간 뒤 Webhook을 설정할 수 있다.</p><img width="1792" alt="스크린샷 2024-01-09 오전 11 19 23" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/31edfa87-12ad-4add-acba-012e537d557c"><center>Github 저장소 내 Webhook 설정 - 1</center><p>&nbsp;</p><p>Payload URL에 <code>http://&lt;퍼블릭 IP&gt;:8080/github-webhook/</code> 로 설정하면 된다.</p><img width="1792" alt="스크린샷 2024-01-09 오전 11 23 01" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/483dca80-f6c4-493c-a1c1-44c2324775ef"><center>Github 저장소 내 Webhook 설정 - 2</center><p>&nbsp;</p><p>Github와 연결을 완료하였으니 코드가 수정될 경우 수행할 작업들을 정의하도록 하겠다.</p><img width="1792" alt="스크린샷 2024-01-09 오후 3 30 01" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/f3b3ba62-bb6c-48d7-829e-1964bbabaf2f"><center>Jenkins Job 설정 화면 - 1</center><p>&nbsp;</p><img width="1792" alt="스크린샷 2024-01-09 오후 3 30 29" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/93af2d6f-b7d3-4655-a8ab-cc1471e08d44"><center>Jenkins Job 설정 화면 - 2</center><p>&nbsp;</p><p>아래 이미지와 마찬가지로 ‘소스 코드 관리’ 탭에서 연결하고자 하는 Git 주소, Credential, Branch를 설정해주었다. 필자는 <code>main</code> branch 기준이므로 수정하였다.</p><img width="1792" alt="스크린샷 2024-01-09 오후 3 43 07" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/b8455e3d-16b8-4b51-85ac-5297f4862f67"><center>Jenkins Job 설정 화면 - 브랜치 설정</center><p>&nbsp;</p><p>이후 ‘빌드 유발’ 탭에서 Github Webhook과 관련된 <code>GitHub hook trigger for GITScm polling</code> 옵션을 활성화해준 뒤, ‘Build Steps’에서 <code>Execute Shell</code> 탭을 선택한 뒤 수행할 일련의 명령어들을 정의하였다.</p><img width="1792" alt="스크린샷 2024-01-09 오후 3 48 20" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/cc7b35fe-d91c-4d1f-a45e-18f4a967da10"><center>Jenkins Job 설정 화면 - 빌드 명령어 설정</center><p>&nbsp;</p><p>참고로 필자의 경우 실제론 Postgresql, Django, Nginx 3개의 Docker-compose로 구성된 환경이나 Jenkins 내부에서는 Django에 대한 테스트를 수행할 것이므로 위와 같이 빌드 명령어를 작성하였다.</p><p>또한 위 명령어는 Jenkins Docker Container 내부에서 수행되는데, 현재 해당 Conatiner 내부에는 파이썬을 비롯한 별도의 패키지들이 설치되어 있지 않다. 따라서 아래 명령어를 통해 이를 설치하고자 한다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Container 진입을 위한 명령어</span></span><br><span class="line">docker <span class="built_in">exec</span> -it --user root &lt;container 이름&gt; /bin/bash</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 패키지 업데이트</span></span><br><span class="line">apt-get update -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># 필수 패키지 설치</span></span><br><span class="line">apt-get install -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># Docker 설치</span></span><br><span class="line">apt-get install docker.io -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># python &amp; pip 설치</span></span><br><span class="line">apt-get install python3 pip -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># Django 설치</span></span><br><span class="line">apt-get install python3-django</span><br></pre></td></tr></table></figure><p>이후 연결한 Github 저장소에 들어가 코드를 수정하면 아래와 같이 Jenkins에서 빌드가 수행됨을 확인할 수 있다.</p><img width="1788" alt="스크린샷 2024-01-09 오후 4 58 32" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/bd5a1094-8f0b-4986-bb8e-4cac1c4b6561"><center>Jenkins 빌드 수행 화면 - 진행중</center><p>&nbsp;</p><img width="1792" alt="스크린샷 2024-01-09 오후 4 58 41" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/4905fe87-942c-4227-8ab8-c3566cf7708a"><center>Jenkins 빌드 수행 화면 - 성공</center><p>&nbsp;</p><h1 id="참고-문헌"><a href="#참고-문헌" class="headerlink" title="참고 문헌"></a>참고 문헌</h1><p><a href="https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/UserGuide/concepts.html">Amazon EC2란 무엇인가요?</a>)</p><p><a href="https://www.itworld.co.kr/news/107527">젠킨스란 무엇인가, CI(Continuous Integration) 서버의 이해</a>)</p><p><a href="https://sws1223.tistory.com/9">Django + jenkins + docker CI&#x2F;CD 구축기</a>)</p><p><a href="https://velog.io/@tank3a/AWS%EC%97%90-Jenkins%EB%A5%BC-%EA%B5%AC%EC%B6%95%ED%95%B4%EB%B3%B4%EC%9E%90-3-Jenkins-%EC%B4%88%EA%B8%B0%EC%84%A4%EC%A0%95">AWS에 Jenkins를 구축해보자</a>)</p><p><a href="https://junhyunny.github.io/information/jenkins/github/jenkins-github-webhook/">젠킨스(Jenkins) Github Webhooks 연결</a>)</p><p><a href="https://junhyunny.github.io/information/docker/make-private-docker-registry-on-ec2/">비공개 도커 레지스트리(private docker registry) 만들기</a>)</p><p><a href="https://syaamex.hashnode.dev/devops-project-jenkins-cicd">End to End Project: Deployed Django Application with Jenkins CI&#x2F;CD Pipeline</a>)</p><p><a href="https://tape22.tistory.com/16">Springboot Gradle + AWS EC2 + Jenkins + Docker로 배포까지</a>)</p><p><a href="https://data-make.tistory.com/772">[AWS EC2] Jenkins in Docker 배포 자동화 구축</a>)</p><p><a href="https://www.dongyeon1201.kr/9026133b-31be-4b58-bcc7-49abbe893044">Jenkins를 활용한 DevOps 환경 구축</a>)</p><p><a href="https://www.lechuck.blog/post/AWS-EC2%EC%97%90-Docker-Compose-%EA%B5%AC%EC%B6%95%ED%95%98%EA%B8%B0">AWS EC2에 Docker-Compose 구축하기</a>)</p>]]></content:encoded>
      
      
      <category domain="https://bigpie1367.github.io/categories/Infra/">Infra</category>
      
      
      <category domain="https://bigpie1367.github.io/tags/Infra/">Infra</category>
      
      <category domain="https://bigpie1367.github.io/tags/DevOps/">DevOps</category>
      
      <category domain="https://bigpie1367.github.io/tags/Docker/">Docker</category>
      
      <category domain="https://bigpie1367.github.io/tags/Amazon/">Amazon</category>
      
      <category domain="https://bigpie1367.github.io/tags/AWS/">AWS</category>
      
      <category domain="https://bigpie1367.github.io/tags/Jenkins/">Jenkins</category>
      
      <category domain="https://bigpie1367.github.io/tags/CI-CD/">CI/CD</category>
      
      <category domain="https://bigpie1367.github.io/tags/CI/">CI</category>
      
      
      <comments>https://bigpie1367.github.io/2024/01/11/AWS-EC2-Jenkins%EB%A5%BC-%ED%86%B5%ED%95%9C-CI-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%B6%95/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Web Server부터 Nginx까지</title>
      <link>https://bigpie1367.github.io/2024/01/05/Web-Server%EB%B6%80%ED%84%B0-Nginx%EA%B9%8C%EC%A7%80/</link>
      <guid>https://bigpie1367.github.io/2024/01/05/Web-Server%EB%B6%80%ED%84%B0-Nginx%EA%B9%8C%EC%A7%80/</guid>
      <pubDate>Fri, 05 Jan 2024 03:42:10 GMT</pubDate>
      
      <description>&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;h1 id=&quot;서론&quot;&gt;&lt;a href=&quot;#서론&quot; class=&quot;headerlink&quot; title=&quot;서론&quot;&gt;&lt;/a&gt;서론&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;Nginx&lt;/strong&gt;(&lt;strong&gt;엔진엑스&lt;/strong&gt;) 에 대해 찾아보는 와중 기존 내가 알고있던 &lt;strong&gt;웹 서버&lt;/strong&gt;(&lt;strong&gt;Web Server&lt;/strong&gt;)에 대한 개념이 상충하는 것이 있어 이를 정리하고자 한다. 본 글에서는 &lt;strong&gt;Web Server&lt;/strong&gt;와 &lt;strong&gt;WAS&lt;/strong&gt;의 개념 비교부터 시작하여 가장 보편적으로 사용되는 &lt;strong&gt;Web Server&lt;/strong&gt; 엔진 및 실제 사용될 수 있는 프로젝트 구성을 &lt;strong&gt;Docker-compose&lt;/strong&gt;를 통해 구성해보고자 한다.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;br&gt;&amp;nbsp;&lt;/p&gt;
&lt;h1 id=&quot;본론&quot;&gt;&lt;a href=&quot;#본론&quot; class=&quot;headerlink&quot; title=&quot;본론&quot;&gt;&lt;/a&gt;본론&lt;/h1&gt;&lt;h2 id=&quot;Web-Server&quot;&gt;&lt;a href=&quot;#Web-Server&quot; class=&quot;headerlink&quot; title=&quot;Web Server&quot;&gt;&lt;/a&gt;Web Server&lt;/h2&gt;&lt;p&gt;위키백과에 정의된 웹 서버에 대한 정의는 다음과 같다&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://ko.wikipedia.org/wiki/%EC%9B%94%EB%93%9C_%EC%99%80%EC%9D%B4%EB%93%9C_%EC%9B%B9&quot;&gt;웹&lt;/a&gt; &lt;a href=&quot;https://ko.wikipedia.org/wiki/%EC%84%9C%EB%B2%84&quot;&gt;서버&lt;/a&gt;&lt;/strong&gt;(Web server)는 다음의 두 가지 뜻 가운데 하나이다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;웹 서버: &lt;a href=&quot;https://ko.wikipedia.org/wiki/%EC%9B%B9_%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80&quot;&gt;웹 브라우저&lt;/a&gt;와 같은 클라이언트로부터 &lt;a href=&quot;https://ko.wikipedia.org/wiki/HTTP&quot;&gt;HTTP&lt;/a&gt; 요청을 받아들이고, &lt;a href=&quot;https://ko.wikipedia.org/wiki/HTML&quot;&gt;HTML&lt;/a&gt; 문서와 같은 웹 페이지를 반환하는 &lt;a href=&quot;https://ko.wikipedia.org/wiki/%EC%BB%B4%ED%93%A8%ED%84%B0_%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8&quot;&gt;컴퓨터 프로그램&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;웹 서버 (하드웨어): 위에 언급한 기능을 제공하는 컴퓨터 프로그램을 실행하는 &lt;a href=&quot;https://ko.wikipedia.org/wiki/%EC%BB%B4%ED%93%A8%ED%84%B0&quot;&gt;컴퓨터&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;웹 서버&lt;/strong&gt;(web server)는 &lt;a href=&quot;https://ko.wikipedia.org/wiki/HTTP&quot;&gt;HTTP&lt;/a&gt; 또는 &lt;a href=&quot;https://ko.wikipedia.org/wiki/HTTPS&quot;&gt;HTTPS&lt;/a&gt;를 통해 &lt;a href=&quot;https://ko.wikipedia.org/wiki/%EC%9B%B9_%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80&quot;&gt;웹 브라우저&lt;/a&gt;에서 요청하는 [HTML 문서나 &lt;a href=&quot;https://ko.wikipedia.org/wiki/%EC%98%A4%EB%B8%8C%EC%A0%9D%ED%8A%B8&quot;&gt;오브젝트&lt;/a&gt;(&lt;a href=&quot;https://ko.wikipedia.org/wiki/%EC%9D%B4%EB%AF%B8%EC%A7%80_%ED%8C%8C%EC%9D%BC&quot;&gt;이미지 파일&lt;/a&gt; 등)을 &lt;a href=&quot;https://ko.wikipedia.org/wiki/%EC%A0%84%EC%86%A1_(%EC%BB%B4%ED%93%A8%ED%8C%85)&quot;&gt;전송&lt;/a&gt;해주는 &lt;a href=&quot;https://ko.wikipedia.org/wiki/%EC%84%9C%EB%B9%84%EC%8A%A4%ED%98%95_%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4&quot;&gt;서비스 프로그램&lt;/a&gt;을 말한다. 웹 서버 소프트웨어를 구동하는 &lt;a href=&quot;https://ko.wikipedia.org/wiki/%ED%95%98%EB%93%9C%EC%9B%A8%EC%96%B4&quot;&gt;하드웨어&lt;/a&gt;도 웹 서버라고 해서 혼동하는 경우가 간혹 있다.&lt;/p&gt;
&lt;p&gt;출처 : &lt;a href=&quot;https://ko.wikipedia.org/wiki/%EC%9B%B9_%EC%84%9C%EB%B2%84&quot;&gt;https://ko.wikipedia.org/wiki/웹_서버&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;위에 정의된 바와 같이 &lt;strong&gt;웹 서버&lt;/strong&gt;란 &lt;strong&gt;HTTP, HTTPS&lt;/strong&gt; 통신 프로토콜을 통해 사용자가 요청하는 &lt;strong&gt;HTML 문서&lt;/strong&gt;나 &lt;strong&gt;오브젝트&lt;/strong&gt;, 즉 &lt;strong&gt;정적인 파일&lt;/strong&gt;들을 전달해주는 서비스 프로그램을 말한다. 다만 이러한 정적인 페이지들의 경우 과거에는 충분하였을 지 모르나 기술이 발달한 요즘 시대에는 부족한 것이 사실이다. 이러한 태생적인 한계를 극복하기 위한 것이 &lt;strong&gt;WAS(Web Application Server)&lt;/strong&gt; 이다.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;br&gt;&amp;nbsp;&lt;/p&gt;</description>
      
      
      
      <content:encoded><![CDATA[<p>&nbsp;</p><h1 id="서론"><a href="#서론" class="headerlink" title="서론"></a>서론</h1><p><strong>Nginx</strong>(<strong>엔진엑스</strong>) 에 대해 찾아보는 와중 기존 내가 알고있던 <strong>웹 서버</strong>(<strong>Web Server</strong>)에 대한 개념이 상충하는 것이 있어 이를 정리하고자 한다. 본 글에서는 <strong>Web Server</strong>와 <strong>WAS</strong>의 개념 비교부터 시작하여 가장 보편적으로 사용되는 <strong>Web Server</strong> 엔진 및 실제 사용될 수 있는 프로젝트 구성을 <strong>Docker-compose</strong>를 통해 구성해보고자 한다.</p><p>&nbsp;<br>&nbsp;</p><h1 id="본론"><a href="#본론" class="headerlink" title="본론"></a>본론</h1><h2 id="Web-Server"><a href="#Web-Server" class="headerlink" title="Web Server"></a>Web Server</h2><p>위키백과에 정의된 웹 서버에 대한 정의는 다음과 같다</p><blockquote><p><strong><a href="https://ko.wikipedia.org/wiki/%EC%9B%94%EB%93%9C_%EC%99%80%EC%9D%B4%EB%93%9C_%EC%9B%B9">웹</a> <a href="https://ko.wikipedia.org/wiki/%EC%84%9C%EB%B2%84">서버</a></strong>(Web server)는 다음의 두 가지 뜻 가운데 하나이다.</p><ol><li>웹 서버: <a href="https://ko.wikipedia.org/wiki/%EC%9B%B9_%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80">웹 브라우저</a>와 같은 클라이언트로부터 <a href="https://ko.wikipedia.org/wiki/HTTP">HTTP</a> 요청을 받아들이고, <a href="https://ko.wikipedia.org/wiki/HTML">HTML</a> 문서와 같은 웹 페이지를 반환하는 <a href="https://ko.wikipedia.org/wiki/%EC%BB%B4%ED%93%A8%ED%84%B0_%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8">컴퓨터 프로그램</a></li><li>웹 서버 (하드웨어): 위에 언급한 기능을 제공하는 컴퓨터 프로그램을 실행하는 <a href="https://ko.wikipedia.org/wiki/%EC%BB%B4%ED%93%A8%ED%84%B0">컴퓨터</a></li></ol><p><strong>웹 서버</strong>(web server)는 <a href="https://ko.wikipedia.org/wiki/HTTP">HTTP</a> 또는 <a href="https://ko.wikipedia.org/wiki/HTTPS">HTTPS</a>를 통해 <a href="https://ko.wikipedia.org/wiki/%EC%9B%B9_%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80">웹 브라우저</a>에서 요청하는 [HTML 문서나 <a href="https://ko.wikipedia.org/wiki/%EC%98%A4%EB%B8%8C%EC%A0%9D%ED%8A%B8">오브젝트</a>(<a href="https://ko.wikipedia.org/wiki/%EC%9D%B4%EB%AF%B8%EC%A7%80_%ED%8C%8C%EC%9D%BC">이미지 파일</a> 등)을 <a href="https://ko.wikipedia.org/wiki/%EC%A0%84%EC%86%A1_(%EC%BB%B4%ED%93%A8%ED%8C%85)">전송</a>해주는 <a href="https://ko.wikipedia.org/wiki/%EC%84%9C%EB%B9%84%EC%8A%A4%ED%98%95_%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4">서비스 프로그램</a>을 말한다. 웹 서버 소프트웨어를 구동하는 <a href="https://ko.wikipedia.org/wiki/%ED%95%98%EB%93%9C%EC%9B%A8%EC%96%B4">하드웨어</a>도 웹 서버라고 해서 혼동하는 경우가 간혹 있다.</p><p>출처 : <a href="https://ko.wikipedia.org/wiki/%EC%9B%B9_%EC%84%9C%EB%B2%84">https://ko.wikipedia.org/wiki/웹_서버</a></p></blockquote><p>위에 정의된 바와 같이 <strong>웹 서버</strong>란 <strong>HTTP, HTTPS</strong> 통신 프로토콜을 통해 사용자가 요청하는 <strong>HTML 문서</strong>나 <strong>오브젝트</strong>, 즉 <strong>정적인 파일</strong>들을 전달해주는 서비스 프로그램을 말한다. 다만 이러한 정적인 페이지들의 경우 과거에는 충분하였을 지 모르나 기술이 발달한 요즘 시대에는 부족한 것이 사실이다. 이러한 태생적인 한계를 극복하기 위한 것이 <strong>WAS(Web Application Server)</strong> 이다.</p><p>&nbsp;<br>&nbsp;</p><h2 id="WAS-Web-Application-Server"><a href="#WAS-Web-Application-Server" class="headerlink" title="WAS (Web Application Server)"></a>WAS (Web Application Server)</h2><p>마찬가지로 위키백과에 정의된 웹 어플리케이션 서버에 대한 정의는 다음과 같다.</p><blockquote><p><strong>웹 애플리케이션 서버</strong>(Web Application Server, 약자 <strong>WAS</strong>)는 <a href="https://ko.wikipedia.org/wiki/%EC%9B%B9_%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98">웹 애플리케이션</a>과 <a href="https://ko.wikipedia.org/wiki/%EC%84%9C%EB%B2%84">서버</a> 환경을 만들어 동작시키는 기능을 제공하는 <a href="https://ko.wikipedia.org/wiki/%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4_%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC">소프트웨어 프레임워크</a>이다.<a href="https://ko.wikipedia.org/wiki/%EC%9B%B9_%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98_%EC%84%9C%EB%B2%84#cite_note-1">[1]</a> 인터넷 상에서 <a href="https://ko.wikipedia.org/wiki/HTTP">HTTP</a>를 통해 사용자 컴퓨터나 장치에 애플리케이션을 수행해 주는 <a href="https://ko.wikipedia.org/wiki/%EB%AF%B8%EB%93%A4%EC%9B%A8%EC%96%B4">미들웨어</a>(소프트웨어 엔진)로 볼 수 있다. 웹 애플리케이션 서버는 동적 서버 콘텐츠를 수행하는 것으로 일반적인 웹 서버와 구별이 되며, 주로 데이터베이스 서버와 같이 수행이 된다. 한국에서는 일반적으로 “WAS” 또는 “WAS S&#x2F;W”로 통칭하고 있으며 공공기관에서는 “웹 응용 서버”로 사용되고, 영어권에서는 “Application Server” (약자 AS)로 불린다.</p><p>출처 : <a href="https://en.wikipedia.org/wiki/Application_server">https://en.wikipedia.org/wiki/Application_server</a></p></blockquote><p>즉 <strong>웹 애플리케이션 서버</strong>(이후 WAS)는 우리가 통상적으로 인식하고 있는 웹 서버의 개념과 동일하다고 보면 된다. 사용자의 요청이 단순 정적인 파일 서빙으로 해결이 안 될 경우, 즉 사용자마다 서로 다른 페이지를 보여줘야 허거나 특정 비지니스 로직, 혹은 DB 와의 상호작용이 필요한 경우가 이에 해당된다.</p><p><img src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/fec035ee-2eab-4401-80a0-81dfeb3968c2"><center>출처 : <a href="https://dkswnkk.tistory.com/503?category=551275">https://dkswnkk.tistory.com/503?category=551275</a></center></p><p>&nbsp;</p><p><strong>WAS</strong>는 위 이미지와 같이 <strong>Web Server</strong>와 <strong>Web Container</strong>로 이루어져 있다. 다만 통상적인 개발 과정에서는 <strong>WAS</strong>와 <strong>Web Server</strong>를 분리하여 개발하는 경우가 잦다. 아래와 같은 구조를 의미한다.</p><p><img src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/178542e1-4112-48da-9b9b-e515acf2fafe"><center>출처 : <a href="https://dkswnkk.tistory.com/503?category=551275">https://dkswnkk.tistory.com/503?category=551275</a></center></p><p>&nbsp;</p><p>즉 1차적으로 사용자가 요청한 내용을 <strong>Web Server</strong>에서 처리한다. 해당 요청이 단순 정적인 파일 서빙으로 해결될 수 있는 문제의 경우 <strong>Web Server</strong>가 자체적으로 해당 파일을 서빙하여 해결한다. 다만 <strong>비즈니스 로직</strong>이나 <strong>DB 조회</strong>가 필요한 <strong>동적인 파일</strong>의 경우 <strong>WAS</strong>에 요청하여 해당 요청을 처리한다.</p><p>&nbsp;</p><p>이와 같은 구조로 구성할 경우 아래와 같은 장점을 얻을 수 있다.</p><h3 id="1-WAS-서버-부하-방지"><a href="#1-WAS-서버-부하-방지" class="headerlink" title="1. WAS 서버 부하 방지"></a>1. WAS 서버 부하 방지</h3><p><strong>WAS</strong> 서버는 실제 비즈니스 로직 및 DB 조회를 담당하는데, 단순 정적 파일 또한 WAS에서 서빙할 경우 다른 작업으로 인해 불필요한 딜레이가 발생할 수 있다.</p><h3 id="2-로직-분리를-통한-보안-강화"><a href="#2-로직-분리를-통한-보안-강화" class="headerlink" title="2. 로직 분리를 통한 보안 강화"></a>2. 로직 분리를 통한 보안 강화</h3><p>일반적인 사용자들은 <strong>Web Server</strong>에만 접근하고 <strong>WAS</strong>는 알 필요가 없다. 따라서 사용자들에게 노출되는 부분은 <strong>Web Server</strong>로 한정지어 불필요한 위험으로부터 분리하여 비즈니스 로직 등 중요 데이터들을 안전하게 지킬 수 있다.</p><h3 id="3-다수의-WAS-서버-연결"><a href="#3-다수의-WAS-서버-연결" class="headerlink" title="3. 다수의 WAS 서버 연결"></a>3. 다수의 WAS 서버 연결</h3><p>동일한 서비스를 제공하는 복수의 <strong>WAS</strong> 서버를 연결하여 특정 서버에 가해지는 부하를 줄일 수 있다 (<strong>Load Balancing</strong>). 또한 특정 한 서버가 다운 되더라도 여분의 서버를 통해 안정적인 서비스를 제공할 수 있다 (<strong>Fail Over</strong>)</p><h3 id="4-여러-웹-어플리케이션과의-연결"><a href="#4-여러-웹-어플리케이션과의-연결" class="headerlink" title="4. 여러 웹 어플리케이션과의 연결"></a>4. 여러 웹 어플리케이션과의 연결</h3><p>서로 다른 기능을 담당하는 <strong>WAS</strong>를 연결하여 복수의 서비스를 제공할 수 있다</p><p>&nbsp;<br>&nbsp;</p><h2 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h2><p><strong>Nginx</strong>(<strong>엔진엑스</strong>)란 <strong>Web Server</strong>의 일종으로, 현재 가장 상용화 된 방식 중 하나이다. 과거엔 <strong>Apahce</strong>(<strong>아파치</strong>)를 활용하여 <strong>Web Server</strong>를 구현하였는데, <strong>Apache</strong>는 쓰레드 방식으로 하나의 요청당 하나의 쓰레드가 새로 생성되어 해당 요청을 처리하는 방식이다. 이러한 방식의 경우 쓰레드를 생성하고 또 요청을 처리하기까지 많은 오버헤드가 발생하게 되어 사용에 꺼려지고 있다.</p><p><strong>Nginx</strong>는 이와 대조적으로 사전 정의된 설정값(*.conf)에 따라 <strong>Worker Process</strong>가 생성되고, 이 <strong>Worker Process</strong>가 일정 시간(<strong>keep alive</strong>)동안 유지되어 사용자의 요청(<strong>Connection</strong>)을 처리하는 방식이다. 이렇게 보면 <strong>Apache</strong>와 큰 차이가 없어 보이지만 가장 큰 핵심은 사용자의 요청을 비동기적으로 처리한다는 것이다. 사용자의 요청은 <strong>Queue</strong>에 대기상태로 쌓이고 유휴상태인 <strong>Worker Process</strong>가 해당 작업을 맡아 처리하는 방식이다. 이를 <strong>Event-Driven</strong> 방식이라 한다.</p><p><img src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/7a8a34ac-8c61-49af-ab95-fe9f0fef76a9"><center>출처 : <a href="https://whatisthenext.tistory.com/123">https://whatisthenext.tistory.com/123</a></center></p><p>&nbsp;</p><p>두 Web Server간의 성능 차이를 비교해보면 아래 이미지와 같다.</p><p><img src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/f91e3a66-deb9-461a-9194-5d542d10ff08"></p><center>Connection 수에 따른 메모리 사용량 비교</center><center>출처 : https://statuslist.app/nginx/variables/</center><p>&nbsp;</p><p><img src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/b6eefe31-9a4f-4f4d-a7e6-8979291ff960"></p><center>동시 요청된 Connection 수에 따른 처리 속도 비교</center><center>출처 : https://statuslist.app/nginx/variables/</center><p>&nbsp;<br>&nbsp;</p><h2 id="Nginx-to-WSGI"><a href="#Nginx-to-WSGI" class="headerlink" title="Nginx to WSGI"></a>Nginx to WSGI</h2><p><strong>WSGI</strong>(<strong>위스키</strong>)는 <strong>Web Server Gateway Interface</strong>의 약자로, <strong>Web Server</strong>와 <strong>Python</strong> 기반의 WAS를 연결해주기 위한 통신 규약이다. 일반적인 <strong>Apache</strong>, <strong>Nginx와</strong> 같은 <strong>Web Server</strong>는 <strong>Python</strong>을 모르기 때문에 <strong>Django</strong>(<strong>장고</strong>)나 <strong>Flask</strong>(<strong>플라스크</strong>) 기반으로 구현된 <strong>WAS</strong>에 요청을 보낼 수 없다. <strong>WSGI</strong>는 그 사이에서 이를 중계해주는 역할이다.</p><p>가장 일반적으로 <strong>Django</strong>는 <strong>Gunicorn</strong>(<strong>지유니콘</strong>)을 사용한다. 다만 <strong>Django</strong>를 경험해본 사람들은 <strong>Gunicorn</strong>을 사용하지 않고도 <strong>Django</strong> 기반 백엔드 서버에서 <strong>HTTP</strong> 통신을 정상적으로 이루었을 것이다. 이는 <code>python manage.py runserver</code> 명령어를 통해 <strong>WAS</strong>를 실행할 경우 기본적으로 <strong>Django</strong> 내장 <strong>WSGI</strong> 서버를 통해 사용자의 <strong>HTTP</strong> 요청을 처리하기 때문이다. 그럼에도 불구하고 장고 내장 <strong>WSGI</strong> 서버가 아닌 <strong>Guicorn</strong>이란 별도의 <strong>WSGI</strong> 서버를 통해 요청을 처리하는 이유는 아래와 같다.</p><blockquote><p>Gunicorn has many features that Django’s built-in server is lacking:</p><ul><li>gunicorn can spawn multiple worker processes to parallelize incoming requests to multiple CPU cores</li><li>gunicorn has better logging</li><li>gunicorn is generally optimized for speed</li><li>gunicorn can be configured to fine grades depending on your setup</li><li>gunicorn is actively designed and maintained with security in mind</li></ul><p>출처 : <a href="https://stackoverflow.com/questions/35657332/django-difference-between-using-server-through-manage-py-and-other-servers-like">https://stackoverflow.com/questions/35657332/django-difference-between-using-server-through-manage-py-and-other-servers-like</a></p></blockquote><p>&nbsp;<br>&nbsp;</p><h1 id="실습"><a href="#실습" class="headerlink" title="실습"></a>실습</h1><p>실습은 <strong>Docker-compose</strong>를 통해 <strong>Postgres</strong>, <strong>Django</strong>, <strong>Nginx</strong> 각각에 해당하는 <strong>Docker Container</strong>를 만들어 구성된 환경에서 진행되었다. 본 실습은 <strong>Docker-compose</strong>를 통해 각 <strong>Container</strong>간의 연결에 초점을 맞춘 관계로 <strong>Django</strong> 프로젝트 설정에 관한 내용은 생략하도록 하겠다. <code>local_settings.py</code>를 통해 <strong>DB</strong> 관련 설정을 해주었단 것만 주의하면 큰 문제는 없을 것이다. 프로젝트 디렉토리 구조는 아래와 같다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &gt; tree</span></span><br><span class="line"></span><br><span class="line">.</span><br><span class="line">├── bin</span><br><span class="line">│   ├── compose</span><br><span class="line">│   │   ├── django</span><br><span class="line">│   │   │   └── Dockerfile</span><br><span class="line">│   │   └── nginx</span><br><span class="line">│   │       └── nginx.conf</span><br><span class="line">│   ├── docker-compose.yml</span><br><span class="line">│   ├── requirements.txt</span><br><span class="line">│   └── restart_docker.sh</span><br><span class="line">└── practice</span><br><span class="line">    ├── manage.py</span><br><span class="line">    ├── practice</span><br><span class="line">    │   ├── __init__.py</span><br><span class="line">    │   ├── asgi.py</span><br><span class="line">    │   ├── local_settings.py</span><br><span class="line">    │   ├── settings.py</span><br><span class="line">    │   ├── urls.py</span><br><span class="line">    │   └── wsgi.py     <span class="comment"># Django 기본 WSGI 서버</span></span><br><span class="line">    └── practice_site</span><br><span class="line">        ├── __init__.py</span><br><span class="line">        ├── admin.py</span><br><span class="line">        ├── apps.py</span><br><span class="line">        ├── fixtures</span><br><span class="line">        │   └── initial_data.json</span><br><span class="line">        ├── migrations</span><br><span class="line">        │   ├── 0001_initial.py</span><br><span class="line">        │   └── __init__.py</span><br><span class="line">        ├── models.py</span><br><span class="line">        ├── tests.py</span><br><span class="line">        ├── urls.py</span><br><span class="line">        └── views.py</span><br></pre></td></tr></table></figure><p><strong>Docker</strong> 컨테이너 구성을 위한 <strong>docker-compose.yml</strong> 파일은 아래와 같다.</p><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ./bin/compose/docker-compose.yml</span></span><br><span class="line"></span><br><span class="line">version: <span class="string">&#x27;3&#x27;</span></span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line">  practice_database:    <span class="comment"># DB 서비스</span></span><br><span class="line">    container_name: practice_database</span><br><span class="line">    image: postgres:<span class="number">15</span></span><br><span class="line">    environment:</span><br><span class="line">      - POSTGRES_DB=practice</span><br><span class="line">      - POSTGRES_USER=practice</span><br><span class="line">      - POSTGRES_PASSWORD=practice</span><br><span class="line"></span><br><span class="line">  practice_web:    <span class="comment"># Django 서비스</span></span><br><span class="line">    container_name: practice_web</span><br><span class="line">    build:</span><br><span class="line">      context: .</span><br><span class="line">      dockerfile: ./compose/django/Dockerfile    <span class="comment"># 별도의 Dokcerfile을 통해 빌드</span></span><br><span class="line">    volumes:</span><br><span class="line">      - ..:/app    <span class="comment"># docker-compose 기준 상대참조하여 /app 디렉토리 내부로 마운트</span></span><br><span class="line">    working_dir: /app/practice</span><br><span class="line">    command: &gt;</span><br><span class="line">      sh -c <span class="string">&quot;</span></span><br><span class="line"><span class="string">        echo yes | python manage.py collectstatic &amp;&amp;    # static 파일을 빌드하기 위한 명령어</span></span><br><span class="line"><span class="string">        wait-for-it.sh practice_database:5432 &amp;&amp;    # DB 설정 완료까지 대기</span></span><br><span class="line"><span class="string">        python manage.py makemigrations &amp;&amp;</span></span><br><span class="line"><span class="string">        python manage.py migrate &amp;&amp;</span></span><br><span class="line"><span class="string">        python manage.py loaddata initial_data.json &amp;&amp;</span></span><br><span class="line"><span class="string">        gunicorn sweat.wsgi:application --workers=20 --timeout=300 --bind 0.0.0.0:8000</span></span><br><span class="line"><span class="string">      &quot;</span></span><br><span class="line">    depends_on:</span><br><span class="line">      - practice_database</span><br><span class="line"></span><br><span class="line">  practice_nginx:    <span class="comment"># Nginx 서비스</span></span><br><span class="line">    container_name: practice_nginx</span><br><span class="line">    image: nginx:latest</span><br><span class="line">    ports:</span><br><span class="line">      - <span class="string">&quot;80:80&quot;</span></span><br><span class="line">    volumes:</span><br><span class="line">      - ../practice/static:/static    <span class="comment"># collectstatic 명령어를 통해 빌드된 파일을 마운트</span></span><br><span class="line">      - ./compose/nginx:/etc/nginx/conf.d    <span class="comment"># conf 설정 파일 마운트</span></span><br><span class="line">    depends_on:</span><br><span class="line">      - practice_web</span><br></pre></td></tr></table></figure><p><strong>Docker-compose</strong> 구성에 사용된 <strong>Dockerfile</strong> 및 <strong>nginx.conf</strong>는 아래와 같다.</p><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .bin/compose/django/Dockerfile</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> python:<span class="number">3.10</span>.<span class="number">6</span></span><br><span class="line"><span class="keyword">ENV</span> PYTHONUNBUFFERED <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get update -y</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># wait-for-it 스크립트를 통해 데이터베이스 설정 완료를 보장</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> wget -O /usr/local/bin/wait-for-it.sh https://raw.githubusercontent.com/vishnubob/wait-for-it/master/wait-for-it.sh</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">chmod</span> +x /usr/local/bin/wait-for-it.sh</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 디렉토리 설정 및 필수 패키지 설치</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> requirements.txt /app/</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> pip install --upgrade pip \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; pip install -r requirements.txt</span></span><br></pre></td></tr></table></figure><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ./bin/compose/nginx/nginx.conf</span></span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen <span class="number">80</span>;</span><br><span class="line">    server_name practice_web;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_http_version <span class="number">1.1</span>;</span><br><span class="line">        proxy_pass http://practice_web:<span class="number">8000</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location /static/ &#123;</span><br><span class="line">        alias /static/;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Docker</strong> 재실행을 위한 스크립트 <strong>restart_docker.sh</strong>는 다음과 같다</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ./bin/compose/restart_docker.sh</span></span><br><span class="line"></span><br><span class="line">docker-compose -p practice down</span><br><span class="line">docker-compose -p practice up -d</span><br></pre></td></tr></table></figure><p>해당 스크립트를 통해 <strong>Docker</strong>를 재실행해보면 아래와 같은 결과를 <strong>Docker-Desktop</strong>에서 확인할 수 있다.</p><img width="1792" alt="image" src="https://github.com/bigpie1367/bigpie1367.github.io/assets/52846766/2f9cea91-6965-48b2-944e-949dd419bfb6"><p>&nbsp;<br>&nbsp;</p><h1 id="참고-문헌"><a href="#참고-문헌" class="headerlink" title="참고 문헌"></a>참고 문헌</h1><p><a href="%5Bhttps://dkswnkk.tistory.com/503?category=551275%5D(https://dkswnkk.tistory.com/503?category=551275)">Web Server와 WAS의 차이</a></p><p><a href="%5Bhttps://velog.io/@bluewind8791/WAS-vs-web-server%5D(https://velog.io/@bluewind8791/WAS-vs-web-server)">WAS vs 웹 서버</a></p><p><a href="%5Bhttps://velog.io/@gillog/Web-Server%EC%99%80-Web-Application-Server%EC%9D%98-%EC%B0%A8%EC%9D%B4%5D(https://velog.io/@gillog/Web-Server%EC%99%80-Web-Application-Server%EC%9D%98-%EC%B0%A8%EC%9D%B4)">Web Server와 Web Application Server</a></p><p><a href="%5Bhttps://velog.io/@leesomyoung/%EC%9B%B9-%EC%84%9C%EB%B2%84-vs-WAS%5D(https://velog.io/@leesomyoung/%EC%9B%B9-%EC%84%9C%EB%B2%84-vs-WAS)">웹 서버 vs WAS</a></p><p><a href="%5Bhttps://yozm.wishket.com/magazine/detail/1780/%5D(https://yozm.wishket.com/magazine/detail/1780/)">웹서버와 WAS(Web Application Server)</a></p><p><a href="%5Bhttps://help.dreamhost.com/hc/en-us/articles/215945987-Web-server-performance-comparison%5D(https://help.dreamhost.com/hc/en-us/articles/215945987-Web-server-performance-comparison)">Web server performance comparison</a></p><p><a href="%5Bhttps://wikidocs.net/75556%5D(https://wikidocs.net/75556)">WSGI 서버</a></p><p><a href="%5Bhttps://sgc109.github.io/2020/08/15/python-wsgi/%5D(https://sgc109.github.io/2020/08/15/python-wsgi/)">WSGI란?</a></p><p><a href="%5Bhttps://ssdragon.tistory.com/60%5D(https://ssdragon.tistory.com/60)">Nginx란?</a></p><p><a href="%5Bhttps://dkswnkk.tistory.com/513%5D(https://dkswnkk.tistory.com/513)">Nginx란 무엇인가?</a></p><p><a href="%5Bhttps://whatisthenext.tistory.com/123%5D(https://whatisthenext.tistory.com/123)">Nginx 이해하기 및 기본 환경 설정 세팅하기</a></p><p><a href="%5Bhttps://phsun102.tistory.com/45%5D(https://phsun102.tistory.com/45)">Nginx 설치 및 nginx.conf, default.conf 이해하기</a></p><p><a href="%5Bhttps://wikidocs.net/6601#static_root%5D(https://wikidocs.net/6601#static_root)">Nginix, Gunicorn 배포</a></p><p><a href="%5Bhttps://velog.io/@devkwon/Django-nginx-%EC%97%B0%EA%B2%B0%ED%95%98%EA%B8%B0%5D(https://velog.io/@devkwon/Django-nginx-%EC%97%B0%EA%B2%B0%ED%95%98%EA%B8%B0)">Django Nginx 연결하기</a></p><p><a href="%5Bhttps://ssungkang.tistory.com/entry/Django-%EC%9B%B9%EC%84%9C%EB%B2%84-Nginx-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0%5D(https://ssungkang.tistory.com/entry/Django-%EC%9B%B9%EC%84%9C%EB%B2%84-Nginx-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0)">Django 웹서버, Nginx 사용하기</a></p><p><a href="%5Bhttps://leffept.tistory.com/331%5D(https://leffept.tistory.com/331)">Docker-compose로 Django 환경 구축하기</a></p><p><a href="%5Bhttps://americanoisice.tistory.com/226%5D(https://americanoisice.tistory.com/226)">Docker-compose로 Django, Nginx, Gunicorn 연결후 AWS 배포하기</a></p><p><a href="%5Bhttps://velog.io/@masterkorea01/Docker-Nginx-gunicorn-django%5D(https://velog.io/@masterkorea01/Docker-Nginx-gunicorn-django)">Docker + Nginx + gunicorn + django</a></p><p><a href="%5Bhttps://stackoverflow.com/questions/35657332/django-difference-between-using-server-through-manage-py-and-other-servers-like%5D(https://stackoverflow.com/questions/35657332/django-difference-between-using-server-through-manage-py-and-other-servers-like)">Django: Difference between using server through manage.py and other servers like gunicorn etc. Which is better?</a></p><p><a href="%5Bhttps://statuslist.app/nginx/variables/%5D(https://statuslist.app/nginx/variables/)">How to use NGINX variables + Reference List</a></p>]]></content:encoded>
      
      
      <category domain="https://bigpie1367.github.io/categories/Backend/">Backend</category>
      
      <category domain="https://bigpie1367.github.io/categories/Backend/Django/">Django</category>
      
      
      <category domain="https://bigpie1367.github.io/tags/Docker/">Docker</category>
      
      <category domain="https://bigpie1367.github.io/tags/Backend/">Backend</category>
      
      <category domain="https://bigpie1367.github.io/tags/Django/">Django</category>
      
      <category domain="https://bigpie1367.github.io/tags/Web-Server/">Web Server</category>
      
      <category domain="https://bigpie1367.github.io/tags/WAS/">WAS</category>
      
      <category domain="https://bigpie1367.github.io/tags/Nginx/">Nginx</category>
      
      
      <comments>https://bigpie1367.github.io/2024/01/05/Web-Server%EB%B6%80%ED%84%B0-Nginx%EA%B9%8C%EC%A7%80/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
